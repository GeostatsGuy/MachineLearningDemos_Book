

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Artificial Neural Networks &#8212; Applied Machine Learning in Python</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/myfile.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'MachineLearning_ANN';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Time Series Analysis and Modeling" href="MachineLearning_time_series.html" />
    <link rel="prev" title="Support Vector Machines" href="MachineLearning_support_vector_machines.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/AppliedMachineLearning.jpg" class="logo__image only-light" alt="Applied Machine Learning in Python - Home"/>
    <script>document.write(`<img src="_static/AppliedMachineLearning.jpg" class="logo__image only-dark" alt="Applied Machine Learning in Python - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="MachineLearning_concepts.html">Machine Learning Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="MachineLearning_training_tuning.html">Training and Tuning</a></li>
<li class="toctree-l1"><a class="reference internal" href="MachineLearning_workflow_construction.html">Workflow Construction and Coding</a></li>
<li class="toctree-l1"><a class="reference internal" href="MachineLearning_probability.html">Probability Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="MachineLearning_plotting_data_models.html">Loading and Plotting Data and Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="MachineLearning_univariate_analysis.html">Univariate Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="MachineLearning_multivariate_analysis.html">Multivariate Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="MachineLearning_feature_transformations.html">Feature Transformations</a></li>
<li class="toctree-l1"><a class="reference internal" href="MachineLearning_feature_ranking.html">Feature Ranking</a></li>
<li class="toctree-l1"><a class="reference internal" href="MachineLearning_feature_imputation.html">Feature Imputation</a></li>
<li class="toctree-l1"><a class="reference internal" href="MachineLearning_clustering.html">Cluster Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="MachineLearning_density-based_clustering.html">Density-based Clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="MachineLearning_spectral_clustering.html">Spectral Clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="MachineLearning_PCA.html">Principal Components Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="MachineLearning_multidimensional_scaling.html">Multidimensional Scaling</a></li>
<li class="toctree-l1"><a class="reference internal" href="MachineLearning_random_projection.html">Random Projection</a></li>
<li class="toctree-l1"><a class="reference internal" href="MachineLearning_linear_regression.html">Linear Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="MachineLearning_ridge_regression.html">Ridge Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="MachineLearning_LASSO_regression.html">LASSO Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="MachineLearning_Bayesian_linear_regression.html">Bayesian Linear Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="MachineLearning_naive_Bayes.html">Naive Bayes</a></li>
<li class="toctree-l1"><a class="reference internal" href="MachineLearning_polynomial_regression.html">Polynomial Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="MachineLearning_knearest_neighbours.html">k-Nearest Neighbours</a></li>
<li class="toctree-l1"><a class="reference internal" href="MachineLearning_decision_tree.html">Decision Trees</a></li>
<li class="toctree-l1"><a class="reference internal" href="MachineLearning_ensemble_trees.html">Bagging Tree and Random Forest</a></li>
<li class="toctree-l1"><a class="reference internal" href="MachineLearning_gradient_boosting.html">Gradient Boosting</a></li>
<li class="toctree-l1"><a class="reference internal" href="MachineLearning_support_vector_machines.html">Support Vector Machines</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Artificial Neural Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="MachineLearning_time_series.html">Time Series Analysis and Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="conclusions.html">Conclusions</a></li>
<li class="toctree-l1"><a class="reference internal" href="MachineLearning_glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="references.html">References</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/GeostatsPyDemos_Book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/GeostatsPyDemos_Book/issues/new?title=Issue%20on%20page%20%2FMachineLearning_ANN.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/MachineLearning_ANN.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Artificial Neural Networks</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#motivation">Motivation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#concepts">Concepts</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-simple-network">A Simple Network</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#walkthrough-the-network">Walkthrough the Network</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#number-of-model-parameters">Number of Model Parameters</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#activation-functions">Activation Functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#training-model-parameters">Training Model Parameters</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#backpropagation">Backpropagation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#updating-model-parameters">Updating Model Parameters</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#training-epochs">Training Epochs</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interactive-dashboard">Interactive Dashboard</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-required-packages">Import Required Packages</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#declare-functions">Declare Functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-simple-ann">The Simple ANN</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#now-visualize-the-network-for-a-specific-epoch">Now Visualize the Network for a Specific Epoch</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#check-the-ann-convergence">Check the ANN Convergence</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comments">Comments</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#about-the-author">About the Author</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#want-to-work-together">Want to Work Together?</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <figure style="text-align: center;">
  <img src="_static/intro/title_page.png" style="display: block; margin: 0 auto; width: 100%;">
</figure>
<section id="artificial-neural-networks">
<h1>Artificial Neural Networks<a class="headerlink" href="#artificial-neural-networks" title="Permalink to this heading">#</a></h1>
<p>Michael J. Pyrcz, Professor, The University of Texas at Austin</p>
<p><a class="reference external" href="https://twitter.com/geostatsguy">Twitter</a> | <a class="reference external" href="https://github.com/GeostatsGuy">GitHub</a> | <a class="reference external" href="http://michaelpyrcz.com">Website</a> | <a class="reference external" href="https://scholar.google.com/citations?user=QVZ20eQAAAAJ&amp;hl=en&amp;oi=ao">GoogleScholar</a> | <a class="reference external" href="https://www.amazon.com/Geostatistical-Reservoir-Modeling-Michael-Pyrcz/dp/0199731446">Geostatistics Book</a> | <a class="reference external" href="https://www.youtube.com/channel/UCLqEr-xV-ceHdXXXrTId5ig">YouTube</a>  | <a class="reference external" href="https://geostatsguy.github.io/GeostatsPyDemos_Book/intro.html">Applied Geostats in Python e-book</a> | <a class="reference external" href="https://geostatsguy.github.io/MachineLearningDemos_Book/">Applied Machine Learning in Python e-book</a> | <a class="reference external" href="https://www.linkedin.com/in/michael-pyrcz-61a648a1">LinkedIn</a></p>
<p>Chapter of e-book ‚ÄúApplied Machine Learning in Python: a Hands-on Guide with Code‚Äù.</p>
<div class="remove-from-content-only admonition">
<p class="admonition-title">Cite this e-Book as:</p>
<p>Pyrcz, M.J., 2024, <em>Applied Machine Learning in Python: A Hands-on Guide with Code</em> [e-book]. Zenodo. doi:10.5281/zenodo.15169138 <a class="reference external" href="https://doi.org/10.5281/zenodo.15169138"><img alt="DOI" src="https://zenodo.org/badge/863274676.svg" /></a></p>
</div>
<p>The workflows in this book and more are available here:</p>
<div class="remove-from-content-only admonition">
<p class="admonition-title">Cite the MachineLearningDemos GitHub Repository as:</p>
<p>Pyrcz, M.J., 2024, <em>MachineLearningDemos: Python Machine Learning Demonstration Workflows Repository</em> (0.0.3) [Software]. Zenodo. DOI: 10.5281/zenodo.13835312. GitHub repository: <a class="github reference external" href="https://github.com/GeostatsGuy/MachineLearningDemos">GeostatsGuy/MachineLearningDemos</a> <a class="reference external" href="https://zenodo.org/doi/10.5281/zenodo.13835312"><img alt="DOI" src="https://zenodo.org/badge/862519860.svg" /></a></p>
</div>
<p>By Michael J. Pyrcz <br />
¬© Copyright 2024.</p>
<p>This chapter is a tutorial for / demonstration of <strong>Artificial Neural Networks</strong>.</p>
<p><strong>YouTube Lecture</strong>: check out my lectures on:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://youtu.be/A9PiCMY_6nM?si=NxWSU_5RgQ4w55EL">Artificial Neural Networks</a></p></li>
<li><p><a class="reference external" href="https://youtu.be/za2my_XDoOs?si=LeHU6p2_fc9dX4Yt">Convolutional Neural Networks</a></p></li>
</ul>
<p>These lectures are all part of my <a class="reference external" href="https://youtube.com/playlist?list=PLG19vXLQHvSC2ZKFIkgVpI9fCjkN38kwf&amp;si=XonjO2wHdXffMpeI">Machine Learning Course</a> on YouTube with linked well-documented Python workflows and interactive dashboards. My goal is to share accessible, actionable, and repeatable educational content. If you want to know about my motivation, check out <a class="reference external" href="https://michaelpyrcz.com/my-story">Michael‚Äôs Story</a>.</p>
<section id="motivation">
<h2>Motivation<a class="headerlink" href="#motivation" title="Permalink to this heading">#</a></h2>
<p>Artificial neural networks are very powerful, nature inspired computing based on an analogy of brain</p>
<ul class="simple">
<li><p>I suggest that they are like a reptilian brain, without planning and higher order reasoning</p></li>
</ul>
<p>In addition, artificial neural networks are a building block of many other deep learning methods, for example,</p>
<ul class="simple">
<li><p>convolutional neural networks</p></li>
<li><p>recurrent neural networks</p></li>
<li><p>generative adversarial networks</p></li>
<li><p>autoencoders</p></li>
</ul>
<p>Nature inspired computing is looking to nature for inspiration to develop novel problem-solving methods,</p>
<ul class="simple">
<li><p><strong>artificial neural networks</strong> are inspired by biological neural networks</p></li>
<li><p><strong>nodes</strong> -  in our model are artificial neurons, simple processors</p></li>
<li><p><strong>connections</strong> between nodes are artificial synapses</p></li>
</ul>
<p>intelligence emerges from many connected simple processors. For the remainder of this chapter, I will used the terms nodes and connections to describe our artificial neural network.</p>
</section>
<section id="concepts">
<h2>Concepts<a class="headerlink" href="#concepts" title="Permalink to this heading">#</a></h2>
<p>Here are some key aspects of artificial neural networks,</p>
<p><strong>Basic Design</strong> - <em>‚Äú‚Ä¶a computing system made up of a number of simple, highly interconnected processing elements, which process information by their dynamic state response to external inputs.‚Äù</em> Caudill (1989).</p>
<p><strong>Still a Prediction Model</strong> - while these models may be quite complicated with even millions of trainable model parameters, weights and biases, they are still a function that maps from predictor features to response features,</p>
<div class="math notranslate nohighlight">
\[
Y=f(X)+\epsilon
\]</div>
<p><strong>Supervised learning</strong> ‚Äì we provide training data with predictor features, <span class="math notranslate nohighlight">\(X_1,\ldots,ùëã_ùëö\)</span> and response feature(s), <span class="math notranslate nohighlight">\(ùëå_1,\ldots,ùëå_K\)</span>, with the expectation of some model prediction error, <span class="math notranslate nohighlight">\(\epsilon\)</span>.</p>
<p><strong>Nonlinearity</strong> - nonlinearity is imparted to the system through the application of nonlinear activation functions to model nonlinear relationships</p>
<p><strong>Universal Function Approximator (Universal Approximation Theorem)</strong> - ANNs have the ability to learn any possible function shape of <span class="math notranslate nohighlight">\(f\)</span> over an interval, for an arbitrary wide (single hidden layer) by Cybenko (1989) and arbitrary depth by Lu and others (2017)</p>
</section>
<section id="a-simple-network">
<h2>A Simple Network<a class="headerlink" href="#a-simple-network" title="Permalink to this heading">#</a></h2>
<p>To get started, let‚Äôs build a neural net, single hidden layer, fully connected, feed-forward neural network,</p>
<figure style="text-align: center;">
  <img src="_static/ANN/ann.png" style="display: block; margin: 0 auto; width: 60%;">
  <figcaption style="text-align: center;"> Simple demonstration artificial neural network.
</figcaption>
</figure>
<p>We use this example artificial neural network in the descriptions below and as an actual example that we will train and predict with by-hand!</p>
<p>Now let‚Äôs label the parts of our network,</p>
<figure style="text-align: center;">
  <img src="_static/ANN/ann_parts.png" style="display: block; margin: 0 auto; width: 75%;">
  <figcaption style="text-align: center;"> Simple demonstration artificial neural network with the parts labeled, including 3 inputs nodes, 2 hidden nodes and 1 output node fully connected.
</figcaption>
</figure>
<p>Our artificial neural network has,</p>
<ul class="simple">
<li><p>3 predictor features, <span class="math notranslate nohighlight">\(X_1, X_2, X_3\)</span></p></li>
<li><p>3 input nodes</p></li>
<li><p>2 hidden layer nodes</p></li>
<li><p>1 output node</p></li>
<li><p>1 response feature, <span class="math notranslate nohighlight">\(Y_1\)</span></p></li>
</ul>
<p>where all nodes fully connected. Note, deep learning is a neural network with more than 1 hidden layer, but for brevity let‚Äôs continue with our non-deep learning artificial neural network.</p>
<p>Let‚Äôs walk through some concepts,</p>
<p><strong>Feed-forward</strong> ‚Äì all information flows from left to right. Each node sends the same signal along the connections to all the nodes in the next layer, but connection has their own unique trainable weights, including in this example, <span class="math notranslate nohighlight">\(\lambda_{1,4}, \lambda_{2,4}, \ldots, \lambda_{5,6}\)</span></p>
<figure style="text-align: center;">
  <img src="_static/ANN/ann_flow.png" style="display: block; margin: 0 auto; width: 70%;">
  <figcaption style="text-align: center;"> Feed forward, fully connected, with each node sending the same signal to all the nodes in the next layer, each with their trainable weights, including in this example, $\lambda_{1,4}, \lambda_{2,4}, \ldots, \lambda_{5,6}$.
</figcaption>
</figure>
<p><strong>Input Layer</strong> - the input features are passed directly to the input nodes, in the case of continuous predictor features, there is one input node per feature and the features are,</p>
<ul class="simple">
<li><p>min / max normalization to a range [‚àí1,1] or [0,1] to improve activation function sensitivity and to remove the influence of scale differences in predictor features and to improve solution stability, i.e., smooth reduction in the training loss while training</p></li>
</ul>
<figure style="text-align: center;">
  <img src="_static/ANN/ann_input.png" style="display: block; margin: 0 auto; width: 70%;">
  <figcaption style="text-align: center;"> Highlighting the input layer, the first layer that receives the normalized predictor features.
</figcaption>
</figure>
<p>In the case of categorical predictor features, we have one input node per each category for each predictor feature, i.e., after one-hot-encoding of the feature, each encoding is passed to a separate input node.</p>
<ul class="simple">
<li><p>recall one-hot-encoding, 1 if the specific category, 0 otherwise, replaces the categorical feature with a binary vector with length as the number of categories.</p></li>
</ul>
<figure style="text-align: center;">
  <img src="_static/ANN/ann_input_cat.png" style="display: block; margin: 0 auto; width: 90%;">
  <figcaption style="text-align: center;"> The input layer of our artificial neural network highlighted. The first layer that receives one-hot-encoding of a single categorical predictor feature.
</figcaption>
</figure>
<ul class="simple">
<li><p>we could also use a single input node per categorical predictor and assign thresholds to each categories, for example [0.0, 0.5, 1.0] for 3 categories, but this assumes an ordinal categorical feature</p></li>
</ul>
<p><strong>Hidden Layer</strong> -  the input layer values <span class="math notranslate nohighlight">\(I_1, I_2, I_2\)</span> are weighted with learnable weights <span class="math notranslate nohighlight">\(\lambda_{1,4}, \lambda_{2,4}, \lambda_{3,4}, \lambda_{1,5}, \lambda_{2,5}, \lambda_{3,5}\)</span>, and</p>
<p>In the hidden layer nodes, the weighted input layer values, <span class="math notranslate nohighlight">\(\lambda_{1,4} \cdot I_1, \lambda_{2,4} \cdot I_2 \cdot I_2, \ldots, \lambda_{3,5} \cdot I_3\)</span> are summed with the addition of a trainable bias term in each node, <span class="math notranslate nohighlight">\(b_4\)</span> and <span class="math notranslate nohighlight">\(b_5\)</span>.</p>
<ul class="simple">
<li><p>the output from the input layer nodes is constant over the hidden layer nodes, but the weights vary over each input node to hidden layer node connection</p></li>
</ul>
<figure style="text-align: center;">
  <img src="_static/ANN/ann_hidden.png" style="display: block; margin: 0 auto; width: 70%;">
  <figcaption style="text-align: center;"> The hidden layer of our artificial neural network highlighted. The input layer nodes' outputs are weighted and passed into the hidden layer nodes. The output from the input layer nodes is constant but the weights vary over the input layer node to hidden layer node connections.
</figcaption>
</figure>
<p><strong>Output Layer</strong> - for continuous response features there is one output node per normalized response feature.</p>
<ul class="simple">
<li><p>backtransformation from normalized to original response feature(s) are then applied to recover the ultimate prediction</p></li>
<li><p>as with continuous predictor features, min / max normalization is applied to continuous response features to a range [‚àí1,1] or [0,1] to improve activation function sensitivity</p></li>
</ul>
<figure style="text-align: center;">
  <img src="_static/ANN/ann_output.png" style="display: block; margin: 0 auto; width: 70%;">
  <figcaption style="text-align: center;"> The output layer of our artificial neural network highlighted. The hidden layer nodes' outputs are weighted and passed into the output layer nodes. The output from the hidden layer nodes is constant, but the weights vary over the hidden layer node to output layer node connections.
</figcaption>
</figure>
<p>In the case of a categorical response feature, once again one-hot-encoding is applied, therefore, there is one output node per category.</p>
<ul class="simple">
<li><p>the prediction is the probability of each category</p></li>
</ul>
<figure style="text-align: center;">
  <img src="_static/ANN/ann_output_cat.png" style="display: block; margin: 0 auto; width: 80%;">
  <figcaption style="text-align: center;"> Highlighting the input layer, the first layer that receives one-hot-encoding of a single categorical predictor feature.
</figcaption>
</figure>
</section>
<section id="walkthrough-the-network">
<h2>Walkthrough the Network<a class="headerlink" href="#walkthrough-the-network" title="Permalink to this heading">#</a></h2>
<p>Let‚Äôs walkthough the artificial neural network. We follow a single path to illustrate the precise calculations associated with making a prediction with an artificial neural network.</p>
<p><strong>Inside an Input Layer Node</strong> - input layer nodes just pass the predictor features,</p>
<ul class="simple">
<li><p>normalized continuous predictor feature value</p></li>
<li><p>a single one-hot-encoding value [0 or 1] for categorical prediction features</p></li>
</ul>
<p>into the hidden layer nodes, with general vector notation,</p>
<div class="math notranslate nohighlight">
\[
I_j = X_j
\]</div>
<figure style="text-align: center;">
  <img src="_static/ANN/ann_walkthrough_input.png" style="display: block; margin: 0 auto; width: 30%;">
  <figcaption style="text-align: center;"> Walkthrough of an artificial neural network, the input layer node receives one-hot-encoding of a single categorical predictor feature and passes it to all of the hidden layer nodes.
</figcaption>
</figure>
<p>For a single example from the figure above consider,</p>
<div class="math notranslate nohighlight">
\[
I_1 = X_1^N
\]</div>
<p><strong>Inside an Hidden Layer Node</strong></p>
<p>The hidden layer nodes are simple processors. The take linearly weighted combinations of inputs, add a node bias term and then nonlinearly transform the result, this transform is call the activation function, <span class="math notranslate nohighlight">\(\alpha\)</span>.</p>
<ul class="simple">
<li><p>indeed, a very simple processor!</p></li>
<li><p>through many interconnected nodes we gain a very flexible predictor, emergent ability to characterize complicated, nonlinear patterns.</p></li>
</ul>
<p>Prior to activation we have,</p>
<div class="math notranslate nohighlight">
\[
H_{j_{in}} = \sum_{i=1}^{p} \left( \lambda_{i,j} \cdot I_i \right) + b_j
\]</div>
<p>and after activation we have,</p>
<div class="math notranslate nohighlight">
\[
H_j = \alpha \left(ùêª_{ùëó_{ùëñùëõ}} \right)
\]</div>
<p>We can express the simple processor in the node with general vector notation as,</p>
<div class="math notranslate nohighlight">
\[
H_j = \alpha\left(b_j + \lambda_j^T X\right)
\]</div>
<figure style="text-align: center;">
  <img src="_static/ANN/ann_walkthrough_hidden.png" style="display: block; margin: 0 auto; width: 30%;">
  <figcaption style="text-align: center;"> Walkthrough of an artificial neural network, the hidden layer linearly weights the input from each input layer node, adds a node bias term and then applies an activation function and passes this to all nodes in the next layer, i.e., the output layer for our example artificial neural network.
</figcaption>
</figure>
<p>For an example of the simple processor of a hidden layer node, <span class="math notranslate nohighlight">\(H_4\)</span>, from the figure above consider,</p>
<div class="math notranslate nohighlight">
\[
H_4 = \alpha\left( \lambda_{1,4} \cdot I_1 + \lambda_{2,4} \cdot I_2 + \lambda_{3,4} \cdot I_3 + b_4 \right)
\]</div>
<p><strong>Inside an Output Layer Node</strong></p>
<p>The output layer nodes take linearly weighted combinations of nodes‚Äô inputs, adds a node bias term and then transforms the result with an activation function, <span class="math notranslate nohighlight">\(\alpha\)</span>, same as the hidden layer nodes,</p>
<div class="math notranslate nohighlight">
\[
O_j = \alpha\left(b_j + \lambda_j^T H\right)
\]</div>
<p>But unlike the hidden layer nodes, for continuous response features, linear activation is commonly applied,</p>
<div class="math notranslate nohighlight">
\[
O_j = \alpha \left(O_{ùëó_{ùëñùëõ}} \right) = O_{ùëó_{ùëñùëõ}}
\]</div>
<figure style="text-align: center;">
  <img src="_static/ANN/ann_walkthrough_output.png" style="display: block; margin: 0 auto; width: 30%;">
  <figcaption style="text-align: center;"> Walkthrough of an artificial neural network, the output layer linearly weights the input from each hidden layer node, adds a node bias term and then applies an activation function, typically linear for continuous response features and passes this as an output.
</figcaption>
</figure>
<p>and for categorical response features, softmax activation is commonly applied,</p>
<div class="math notranslate nohighlight">
\[
O_j = \alpha(O_{j_{in}}) = \frac{e^{O_{j_{in}}}}{\sum_{\iota=1}^{K} e^{O_{\iota_{in}}}}
\]</div>
<figure style="text-align: center;">
  <img src="_static/ANN/ann_walkthrough_output_cat.png" style="display: block; margin: 0 auto; width: 30%;">
  <figcaption style="text-align: center;"> Walkthrough of an artificial neural network, the output layer linearly weights the input from each hidden layer node, adds a node bias term and then applies an activation function, typically linear for continuous response features and passes this as an output.
</figcaption>
</figure>
<ul class="simple">
<li><p>softmax activation ensures that the output over all the output layer nodes are valid probabilities including,</p></li>
<li><p><strong>nonnegativity</strong> - through the exponentiation</p></li>
<li><p><strong>closure</strong> - probabilities sum to 1.0 through the denominator normalizing the result</p></li>
</ul>
</section>
<section id="number-of-model-parameters">
<h2>Number of Model Parameters<a class="headerlink" href="#number-of-model-parameters" title="Permalink to this heading">#</a></h2>
<p>In general, there are many model parameters, <span class="math notranslate nohighlight">\(theta\)</span>, in an artificial neural network. Consider this notation for artificial neural network width, number of input nodes, <span class="math notranslate nohighlight">\(p\)</span>, number of hidden layer nodes, <span class="math notranslate nohighlight">\(m\)</span>, and number of output nodes, <span class="math notranslate nohighlight">\(k\)</span>.</p>
<figure style="text-align: center;">
  <img src="_static/ANN/parameters.png" style="display: block; margin: 0 auto; width: 30%;">
  <figcaption style="text-align: center;"> Notation for artificial neural network width, number of input nodes, \(p\), number of hidden layer nodes, \(m\), and number of output nodes, \(k\). 
</figcaption>
</figure>
<p>for every connection there is a weight,</p>
<div class="math notranslate nohighlight">
\[
\lambda_{ùêº_{1,\ldots,ùëù},ùêª_{1,\ldots,ùëö} } \quad \text{and} \quad \lambda_{ùêª_{1,\ldots,ùëö},ùëÇ_{1,\ldots,ùëò} }
\]</div>
<p>with full connectivity the number of weights is <span class="math notranslate nohighlight">\(ùëù \times ùëö\)</span> and <span class="math notranslate nohighlight">\(ùëö \times ùëò\)</span> and at each node there is a bias term <span class="math notranslate nohighlight">\(ùëè_{H_{1,\ldots,m} }\)</span> and <span class="math notranslate nohighlight">\(ùëè_{O_{1,\ldots,k} }\)</span>.</p>
<p>the number of model parameters is,</p>
<div class="math notranslate nohighlight">
\[
|\theta| = ùëù \times ùëö + ùëö \times ùëò + ùëö + ùëò 
\]</div>
<p>this assumes an unique bias term at each hidden layer node and output layer node, but in some case the same bias term may be applied over the entire layer.</p>
<p>For our example, with <span class="math notranslate nohighlight">\(p = 3\)</span>, <span class="math notranslate nohighlight">\(m = 2\)</span> and <span class="math notranslate nohighlight">\(k = 1\)</span>, then the number of model parameters are,</p>
<div class="math notranslate nohighlight">
\[
|\theta| = ùëù \times ùëö + ùëö \times ùëò + ùëö + ùëò 
\]</div>
<p>after substitution we have,</p>
<div class="math notranslate nohighlight">
\[
|\theta| = 3 \times 2 + 2 \times 1 + 2 + 1 = 11
\]</div>
<p>I selected this as a manageable number of parameters, so we can train and visualize our model, but consider a more typical model size by increasing our artificial neural network‚Äôs width, with <span class="math notranslate nohighlight">\(p = 10\)</span>, <span class="math notranslate nohighlight">\(m = 20\)</span> and <span class="math notranslate nohighlight">\(k = 3\)</span>, then we have many more model parameters,</p>
<div class="math notranslate nohighlight">
\[
|\theta| = 10 \times 20 + 20 \times 3 + 20 + 3 = 283
\]</div>
<p>if we add hidden layers, increase our artificial neural network‚Äôs depth, the number of model parameters will grow very quickly.</p>
<p>Let‚Äôs clarify these definitions,</p>
<ul class="simple">
<li><p><strong>neural network width</strong> - the number of nodes in the layers of the neural network</p></li>
<li><p><strong>neural network depth</strong> - the number of layers in the neural network, typically the input layer is not included in this calculation</p></li>
</ul>
</section>
<section id="activation-functions">
<h2>Activation Functions<a class="headerlink" href="#activation-functions" title="Permalink to this heading">#</a></h2>
<p>A activation function is a transformation of the linear combination of the weighted node inputs plus the node bias term. Nonlinear activation,</p>
<ul class="simple">
<li><p>introduces non-linear properties to the network</p></li>
<li><p>prevents the network from collapsing</p></li>
</ul>
<p>Without the nonlinear activation function we would have linear regression, the entire system collapses.</p>
<p>Do demonstrate this, let‚Äôs take our example network and remove the activation functions, or assuming a linear transformation,</p>
<figure style="text-align: center;">
  <img src="_static/ANN/ann_no_activation.png" style="display: block; margin: 0 auto; width: 70%;">
  <figcaption style="text-align: center;"> Our simple artificial neural network with connections and model parameters. 
</figcaption>
</figure>
<p>Now we can calculate the prediction ignoring activation, since it is identity or a linear scaling as,</p>
<div class="math notranslate nohighlight">
\[
Y_1 = \lambda_{4,6} \cdot \left( \lambda_{1,4} \cdot X_1 + \lambda_{2,4} \cdot X_2 + \lambda_{3,4} \cdot X_3 + b_{H_4} \right) + 
\lambda_{5,6} \cdot \left( \lambda_{1,5} \cdot X_1 + \lambda_{2,5} \cdot X_2 + \lambda_{3,5} \cdot X_3 + b_{H_5} \right)
\]</div>
<p>Now we can group the like terms,</p>
<div class="math notranslate nohighlight">
\[
Y_1 = (\lambda_{4,6} \cdot \lambda_{1,4} + \lambda_{5,6} \cdot \lambda_{1,5}) \cdot X_1 + 
      (\lambda_{4,6} \cdot \lambda_{2,4} + \lambda_{5,6} \cdot \lambda_{2,5}) \cdot X_2 + 
      (\lambda_{4,6} \cdot \lambda_{3,4} + \lambda_{5,6} \cdot \lambda_{3,5}) \cdot X_3 + 
      (\lambda_{4,6} \cdot b_{H_4} + \lambda_{5,6} \cdot b_{H_5})
\]</div>
<p>and finally, we can group the summed model parameters and replace them with recognizable coefficients,</p>
<div class="math notranslate nohighlight">
\[
Y_1 = b_1 \cdot X_1 + b_2 \cdot X_2 + b_3 \cdot X_3 + b_0
\]</div>
<p>et voil√†! We have linear regression, an artificial neural network without activation collapses to linear regression.</p>
<p>Now that we have demonstrated the necessity of nonlinear activation, here‚Äôs some common activation functions,</p>
<figure style="text-align: center;">
  <img src="_static/ANN/activation.png" style="display: block; margin: 0 auto; width: 90%;">
  <figcaption style="text-align: center;"> Some common activation functions. 
</figcaption>
</figure>
<p>Note the notation in the figure above, the X-axis is the input, <span class="math notranslate nohighlight">\(H_{j_{in}}\)</span>, and the Y-axis is the output after activation, <span class="math notranslate nohighlight">\(H_j\)</span>.</p>
<ol class="arabic simple">
<li><p><strong>Sigmoid</strong> - also known as logistic has the following expression and derivative.</p></li>
</ol>
<div class="math notranslate nohighlight">
\[
f(x) = \frac{1}{1 + e^{-x}}
\]</div>
<div class="math notranslate nohighlight">
\[
f'(x) = f(x) \cdot (1 - f(x))
\]</div>
<ol class="arabic simple" start="2">
<li><p><strong>Tanh</strong> ‚Äì hyperbolic tangent has the following expression and derivative.</p></li>
</ol>
<div class="math notranslate nohighlight">
\[
f(x) = \frac{e^x - e^{-x}}{e^x + e^{-x}}
\]</div>
<div class="math notranslate nohighlight">
\[
f'(x) = 1 - \frac{(e^x - e^{-x})^2}{(e^x + e^{-x})^2}
\]</div>
<ol class="arabic simple" start="3">
<li><p><strong>ReLU</strong> ‚Äì rectified linear units has the following expression and derivative.</p></li>
</ol>
<div class="math notranslate nohighlight">
\[
f(x) = \max(0, x)
\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}
f'(x) = 
\begin{cases} 
1 &amp; \text{if } x &gt; 0 \\
0 &amp; \text{if } x \leq 0
\end{cases}
\end{split}\]</div>
<p>How do we select our activation functions? Considerations these criteria for selecting activation functions,</p>
<ul class="simple">
<li><p><strong>Nonlinear</strong> ‚Äì required to impose nonlinearity into the prediction model (e.g., sigmoid, tanh and ReLU are nonlinear).</p></li>
<li><p><strong>Range</strong> ‚Äì finite for more stability gradient-based learning, infinite for more efficient training, but requires a slower learning rate (e.g., sigmoid <span class="math notranslate nohighlight">\([0,\infty]\)</span>, tanh <span class="math notranslate nohighlight">\([-1,1]\)</span> and ReLU <span class="math notranslate nohighlight">\([0,\infty]\)</span>).</p></li>
<li><p><strong>Continuously Differentiable</strong> ‚Äì required for stable gradient-based optimization (e.g., sigmoid, tanh and ReLU <span class="math notranslate nohighlight">\(\ne 0.0\)</span>)</p></li>
<li><p><strong>Fast Calculation of Derivative</strong> - the derivative calculation has low calculation complexity for efficient training (e.g., sigmoid and ReLU)</p></li>
<li><p><strong>Smooth functions with Monotonic Derivative</strong> ‚Äì may generalize better (e.g., sigmoid, tanh and ReLU)</p></li>
<li><p><strong>Monotonic</strong> ‚Äì guaranteed convexity of error surface of a single layer model, global minimum for loss function (e.g., sigmoid, tanh and ReLU)</p></li>
<li><p><strong>Approximates Identity at the Origin</strong>, <span class="math notranslate nohighlight">\((ùëì(0) = 0)\)</span> ‚Äì learns efficiently with the weights initialized as small random values (e.g., ReLU and tanh)</p></li>
</ul>
</section>
<section id="training-model-parameters">
<h2>Training Model Parameters<a class="headerlink" href="#training-model-parameters" title="Permalink to this heading">#</a></h2>
<p>Training an artificial neural network proceeds iteratively by these steps.</p>
<figure style="text-align: center;">
  <img src="_static/ANN/training_cycle.png" style="display: block; margin: 0 auto; width: 90%;">
  <figcaption style="text-align: center;"> Training an artificial neural network proceeds iteratively by, 1. forward pass to make a prediction, 2. calculate the error derivative based on the prediction and truth over training data, 3. backpropagate the error derivative back through the artificial neural network to calculate the derivatives of the error over all the model weights and biases parameters, 4. update the model parameters based on the derivatives and learning rates, 5. repeat until convergence.
</figcaption>
</figure>
<p>Here‚Äôs some details on each step,</p>
<ol class="arabic simple" start="0">
<li><p><strong>Initializing the Model Parameters</strong> - initialize all model parameters with typically small (near zero) random values. Here‚Äôs a couple common methods,</p></li>
</ol>
<ul class="simple">
<li><p><strong>Xavier Weight Initialization</strong> - random realizations from uniform distributions specified by <span class="math notranslate nohighlight">\(U[\text{min}, \text{max}]\)</span>,</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\lambda_{i,j} = F_U^{-1} \left[ \frac{-1}{\sqrt{p}}, \frac{1}{\sqrt{p}} \right] (p^\ell)
\]</div>
<ul class="simple">
<li><p>where <span class="math notranslate nohighlight">\(F^{-1}_U\)</span> is the inverse of the CDF, <span class="math notranslate nohighlight">\(p\)</span> is the number of inputs, and <span class="math notranslate nohighlight">\(p^{\ell}\)</span> is a random cumulative probability value drawn from the uniform distribution, <span class="math notranslate nohighlight">\(U[0,1]\)</span>.</p></li>
<li><p><strong>Normalized Xavier Weight Initialization</strong> - random realizations from uniform distributions specified by <span class="math notranslate nohighlight">\(U[\text{min}, \text{max}]\)</span>,</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\lambda_{i,j} = F_U^{-1} \left[ \frac{-1}{\sqrt{p}+k}, \frac{1}{\sqrt{p}+k} \right] (p^\ell)
\]</div>
<ul class="simple">
<li><p>where <span class="math notranslate nohighlight">\(F^{-1}_U\)</span> is the inverse of the CDF, <span class="math notranslate nohighlight">\(p\)</span> is the number of inputs, <span class="math notranslate nohighlight">\(k\)</span> is the number of outputs, and <span class="math notranslate nohighlight">\(p^{\ell}\)</span> is a random cumulative probability value drawn from the uniform distribution, <span class="math notranslate nohighlight">\(U[0,1]\)</span>.</p></li>
<li><p>For example, if we return to our first hidden layer node,</p></li>
</ul>
<figure style="text-align: center;">
  <img src="_static/ANN/ann_walkthrough_hidden.png" style="display: block; margin: 0 auto; width: 30%;">
  <figcaption style="text-align: center;"> First hidden layer node with 3 inputs, and 1 output.
</figcaption>
</figure>
<ul class="simple">
<li><p>we have <span class="math notranslate nohighlight">\(p = 3\)</span> and <span class="math notranslate nohighlight">\(k = 1\)</span>, and we draw from the uniform distribution,</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
U \left[ \frac{-1}{\sqrt{p}+k}, \frac{1}{\sqrt{p}+k} \right] = U \left[ \frac{-1}{\sqrt{3}+1}, \frac{1}{\sqrt{3}+1} \right]
\]</div>
<ol class="arabic simple">
<li><p><strong>Forward Pass</strong> - to make a prediction, <span class="math notranslate nohighlight">\(\hat{y}\)</span>. Initial predictions will be random for the first iteration, but will improve.</p></li>
</ol>
<figure style="text-align: center;">
  <img src="_static/ANN/first_prediction.png" style="display: block; margin: 0 auto; width: 70%;">
  <figcaption style="text-align: center;"> Prediction with our artificial neural network initialized with random model parameters, weights and biases.
</figcaption>
</figure>
<ol class="arabic simple" start="2">
<li><p><strong>Calculate the Error Derivative</strong> - given a loss of, <span class="math notranslate nohighlight">\(P = \frac{1}{2} \left(\hat{y} - y \right)^2\)</span>, the error derivative, i.e., rate of change of in error given a change in model estimate is <span class="math notranslate nohighlight">\(\frac{\partial P}{\partial \hat{y}} = \hat{Y} - Y\)</span>.</p></li>
</ol>
<ul class="simple">
<li><p>For now, let‚Äôs only consider a single estimate, and we will address more than 1 training data later.</p></li>
</ul>
<ol class="arabic simple" start="3">
<li><p><strong>Backpropagate the Error Derivative</strong> - we shift back through the artificial neural network to calculate the derivatives of the error over all the model weights and biases parameters, to accomplish this we use the chain rule,</p></li>
</ol>
<div class="math notranslate nohighlight">
\[
\frac{\partial}{\partial x} f(g(h(x))) = \frac{\partial f}{\partial g} \cdot \frac{\partial g}{\partial h} \cdot \frac{\partial h}{\partial x}
\]</div>
<ol class="arabic simple" start="4">
<li><p><strong>Update the Model Parameters</strong> - based on the derivatives, \frac{\partial P}{\partial \lambda_{i,j}} and learning rates, <span class="math notranslate nohighlight">\(\eta\)</span>, like this,</p></li>
</ol>
<div class="math notranslate nohighlight">
\[
\lambda_{i,j}^{\ell} = \lambda_{i,j}^{\ell - 1} + \eta \cdot \frac{\partial P}{\partial \lambda_{i,j}}
\]</div>
<ol class="arabic simple" start="5">
<li><p><strong>Repeat Until Convergence</strong> - return to step 1. until the error, <span class="math notranslate nohighlight">\(P\)</span>, is reduced to an acceptable level, i.e., model convergence is the condition to stop the iterations</p></li>
</ol>
</section>
<section id="backpropagation">
<h2>Backpropagation<a class="headerlink" href="#backpropagation" title="Permalink to this heading">#</a></h2>
<p>We can use the chain rule to perform backpropagation (from the term backward propagation) to step our error partial derivative backwards through out network to learn how each of our artificial neural network weights and biases impact the model prediction error.</p>
<p>For example, given our simple artificial neural network, let‚Äôs backpropagate along a single path in the network,</p>
<figure style="text-align: center;">
  <img src="_static/ANN/backpropagation_example.png" style="display: block; margin: 0 auto; width: 30%;">
  <figcaption style="text-align: center;"> With the chain rule we can backpropagate the error derivative from the output back through the artificial neural network.
</figcaption>
</figure>
<p>Now, I‚Äôll walk you through this, it is actually not as hard as it looks. In fact, the main challenge with backpropagation, once you learn the pattern, is the book keeping!</p>
<ol class="arabic simple">
<li><p>Start with error derivative of the prediction, the output from the output layer node, <span class="math notranslate nohighlight">\(O_6\)</span>, <span class="math notranslate nohighlight">\(\frac{\partial P}{\partial O_6} = O_6 - Y_1^N\)</span></p></li>
</ol>
<ul class="simple">
<li><p>recall the output of output layer node, <span class="math notranslate nohighlight">\(O_6\)</span> is the normalized model prediction, <span class="math notranslate nohighlight">\(\hat{Y}_1^N\)</span>.</p></li>
<li><p>we use the <span class="math notranslate nohighlight">\(O_6\)</span> notation below to help track our backpropagation through the neural network nodes, but we could also state it as,</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\frac{\partial P}{\partial O_6} = \hat{Y}_1^N - Y_1^N$ 
\]</div>
<ol class="arabic simple" start="2">
<li><p>Now backpropagate to before application of the activation function inside of the output layer neuron, <span class="math notranslate nohighlight">\(O_6\)</span>, <span class="math notranslate nohighlight">\(\frac{\partial P}{\partial O_{6_{\text{in}}}} = \frac{\partial O_6}{\partial O_{6_{\text{in}}}} \cdot \frac{\partial P}{\partial O_6}\)</span>.</p></li>
</ol>
<ul class="simple">
<li><p>to assist, I specify <span class="math notranslate nohighlight">\(\frac{\partial O_6}{\partial O_{6_{\text{in}}}}\)</span> as <span class="math notranslate nohighlight">\(\frac{d}{dx} O_{6_{\alpha}}(x)\)</span> and <span class="math notranslate nohighlight">\(\frac{\partial P}{\partial O_6} = O_6 - Y_1^N\)</span> now we get,</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\frac{\partial P}{\partial O_{6_{\text{in}}}} = \frac{d}{dx} O_{6_{\alpha}}(x) \cdot \left(O_6 - Y_1^N \right)
\]</div>
<ul class="simple">
<li><p>note that, <span class="math notranslate nohighlight">\(\frac{d}{dx} O_{6_{\alpha}}(x)\)</span>, is just the derivative of the activation function for the node input, <span class="math notranslate nohighlight">\(x\)</span>, and above we listed the derivatives and commented on the need to calculate these very quickly. As you will see, we calculate many to accomplish backpropagation!</p></li>
<li><p>we could replace <span class="math notranslate nohighlight">\(x\)</span> with the input, with prior to activation calculation in the node, for example, <span class="math notranslate nohighlight">\(H_j = \alpha\left(b_j + \lambda_j^T X\right)\)</span> but can we agree this notation would be totally unwieldly, let‚Äôs stick with <span class="math notranslate nohighlight">\(x\)</span> as input for the activation function</p></li>
<li><p>this is the pattern, use the derivative of the activation function evaluated for the input to backpropagate through the node, from output after activation to input before activation.</p></li>
</ul>
<ol class="arabic simple" start="3">
<li><p>Now backpropagate along the connection <span class="math notranslate nohighlight">\([5,6]\)</span> to the output of the node in the hidden layer, <span class="math notranslate nohighlight">\(H_5\)</span>, and before the application of the weight, <span class="math notranslate nohighlight">\(\lambda_{5,6}\)</span>, by the chain rule we add this term, <span class="math notranslate nohighlight">\(\frac{\partial O_{6_{\text{in}}}}{\partial H_5}\)</span> and get,</p></li>
</ol>
<div class="math notranslate nohighlight">
\[
\frac{\partial P}{\partial H_5} = \frac{\partial O_{6_{\text{in}}}}{\partial H_5} \cdot \frac{\partial O_6}{\partial O_{6_{\text{in}}}} \cdot \frac{\partial P}{\partial O_6}$.
\]</div>
<ul class="simple">
<li><p>to assist, I evaluate <span class="math notranslate nohighlight">\(\frac{\partial O_{6_{\text{in}}}}{\partial H_5}\)</span> as <span class="math notranslate nohighlight">\(\lambda_{5,6}\)</span> and now we get,</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\frac{\partial P}{\partial H_5} = \lambda_{5,6} \cdot \frac{d}{dx} O_{6_{\alpha}}(x) \cdot \left(O_6 - Y_1^N \right)
\]</div>
<ul class="simple">
<li><p>and we have completed the pattern, derivative of the activation function to backpropagate through the node and then the current weight, <span class="math notranslate nohighlight">\(\lambda_{i,j}\)</span>, to backpropagate along the connection!</p></li>
<li><p>with this method we can backpropagate, backward propagate the error derivative backwards through our artificial neural network along any connected path</p></li>
</ul>
<ol class="arabic simple" start="4">
<li><p>To demonstrate this repeating pattern lets continue across the hidden layer node to the input of the node, <span class="math notranslate nohighlight">\(H_{5_{in}}\)</span>,</p></li>
</ol>
<div class="math notranslate nohighlight">
\[
\frac{\partial P}{\partial H_{5_{\text{in}}}} = 
\frac{\partial O_6}{\partial O_{6_{\text{in}}}} \cdot 
\frac{\partial O_{6_{\text{in}}}}{\partial H_5} \cdot 
\frac{\partial H_5}{\partial H_{5_{\text{in}}}} \cdot 
\frac{\partial P}{\partial O_6}
\]</div>
<ul class="simple">
<li><p>and again if we evaluate the partial derivatives we have,</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\frac{\partial P}{\partial H_{5_{\text{in}}}} = \frac{d}{dx} H_{5_{\alpha}}(x) \cdot \lambda_{5,6} \cdot \frac{d}{dx} O_{6_{\alpha}}(x) \cdot \left(O_6 - Y_1^N \right)
\]</div>
<ul class="simple">
<li><p>see the pattern? From right to left we have - error derivative, derivative of activation, weight, derivative of activation, ‚Ä¶</p></li>
<li><p>to further simplify and specify the calculation, let‚Äôs assume the sigmoid activation function, and substitute the sigmoid derivatives,</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\frac{\partial P}{\partial H_{5_{\text{in}}}} = H_{5}(x) \cdot \left(1.0 - H_{5}(x) \right) \cdot \lambda_{5,6} \cdot O_{6}(x) \cdot \left(1.0 - O_{6}(x) \right) \cdot \left(O_6 - Y_1^N \right)
\]</div>
<ul class="simple">
<li><p>and if we use a linear activation for the output node, <span class="math notranslate nohighlight">\(O_6\)</span>, as is typical, the derivative <span class="math notranslate nohighlight">\(\frac{d}{dx} O_{6_{\alpha}}(x) = 1.0\)</span>,</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\frac{\partial P}{\partial H_{5_{\text{in}}}} = H_{5}(x) \cdot \left(1.0 - H_{5}(x) \right) \cdot \lambda_{5,6} \cdot 1.0 \cdot \left(O_6 - Y_1^N \right)
\]</div>
<p>Now we get to the book keeping challenge. If you have a node that can be reached by multiple paths, then we need to add the derivatives across all the paths.</p>
<ul class="simple">
<li><p>for example, let‚Äôs jump to the error gradient at input for input node <span class="math notranslate nohighlight">\(I_1\)</span>,</p></li>
</ul>
<figure style="text-align: center;">
  <img src="_static/ANN/multiple_path.png" style="display: block; margin: 0 auto; width: 70%;">
  <figcaption style="text-align: center;"> Multiple paths for backpropagation to input layer node, $I_1$.
</figcaption>
</figure>
<ul class="simple">
<li><p>for <span class="math notranslate nohighlight">\(\frac{\partial P}{\partial I_{i_{\text{in}}}}\)</span> we sum the two paths and then include the activation function derivative to shift to the input for node <span class="math notranslate nohighlight">\(I_1\)</span> as,</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\frac{\partial P}{\partial I_{i_{\text{in}}}} = 
\left[ \alpha(I_i) \cdot (1 - \alpha(I_i)) \right] \cdot 
\sum_{j=1}^{2} \lambda_{i,j} \cdot 
\frac{\partial P}{\partial H_{j_{\text{in}}}}
\]</div>
<p>and if we once again evaluate each of the partial derivatives,</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial P}{\partial I_{1_{\text{in}}}} =
\left[ \alpha(I_1) \cdot (1 - \alpha(I_1)) \right] \cdot \left[
\lambda_{1,4} \cdot \left[ \alpha(H_4) \cdot (1 - \alpha(H_4)) \right] \cdot \lambda_{4,6} \cdot \left[ \alpha(O_6) \cdot (1 - \alpha(O_6)) \right] \cdot (Y^N - O_6) \right.
\]</div>
<p>With this method we can backpropagate the error derivatives to the inputs for each node in our artificial neural network. Here‚Äôs the result for our first iteration,</p>
<figure style="text-align: center;">
  <img src="_static/ANN/backpropagate_node.png" style="display: block; margin: 0 auto; width: 70%;">
  <figcaption style="text-align: center;"> Back propagation result for the first iteration.
</figcaption>
</figure>
<p>With this approach we can backpropagate the error derivative through our artificial neural network and calculate the derivatives before and after every node,</p>
<ul class="simple">
<li><p>but, we actually need the partical derivatives with respect to the model parameters, the weights and bias terms.</p></li>
<li><p>the good news is that we are almost there! Here‚Äôs some examples for calculating these from our error derivatives for node inputs, prior to activation,</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\frac{\partial P}{\partial \lambda_{4,6}} = H_4 \cdot \frac{\partial P}{\partial O_{6_{\text{in}}}} = 0.42 \cdot 1.00 = 0.42
\]</div>
<div class="math notranslate nohighlight">
\[
\frac{\partial P}{\partial \lambda_{1,4}} = I_1 \cdot \frac{\partial P}{\partial H_{4_{\text{in}}}} = 0.5 \cdot (-0.13) = -0.065
\]</div>
<div class="math notranslate nohighlight">
\[
\frac{\partial P}{\partial b_4} = \frac{\partial P}{\partial H_{4_{\text{in}}}} = -0.32
\]</div>
<p>What is happening?</p>
<ul class="simple">
<li><p>the partial derivative of the connection with respect to the weight is the signal!</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\frac{\partial O_{6_{\text{in}}}}{\partial \lambda_{4,6}} = H4
\]</div>
<div class="math notranslate nohighlight">
\[
\frac{\partial I_{1_{\text{in}}}}{\partial \lambda_{1,4}} = I1
\]</div>
<ul class="simple">
<li><p>and the partial derivatives of the biases are already given as the partial derivatives at the node input, prior to activation!</p></li>
</ul>
<p>Now for weights along the connections from input layer to hidden layer and for the connections from hidden layer to output layer we have,</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial P}{\partial \lambda_{i,j}} = I_i \cdot \frac{\partial P}{\partial I_{j_{\text{in}}}} \quad \text{and} \quad \frac{\partial P}{\partial \lambda_{i,j}} = H_i \cdot \frac{\partial P}{\partial H_{j_{\text{in}}}}
\]</div>
<p>and for biases in the hidden layer and output layer we have,</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial P}{\partial b_j} = \frac{\partial P}{\partial I_{j_{\text{in}}}} \quad \text{and} \quad \frac{\partial P}{\partial b_j} = \frac{\partial P}{\partial H_{j_{\text{in}}}} 
\]</div>
<p>My advice is to review this a couple of times, learn the patterns, and be happy that the computer takes care of the book keeping for us!</p>
</section>
<section id="updating-model-parameters">
<h2>Updating Model Parameters<a class="headerlink" href="#updating-model-parameters" title="Permalink to this heading">#</a></h2>
<p>The derivatives for each of the model parameters are the gradients, so we are ready to use gradient descent optimization with the addition of,</p>
<ul class="simple">
<li><p><strong>learning rate</strong> -  to scale the rate of change of the model updates we assign a learning rate, <span class="math notranslate nohighlight">\(\eta\)</span>. For our model parameter examples from above,</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\lambda_{4,6}^{\ell} = \lambda_{4,6}^{\ell - 1} + \eta \cdot \frac{\partial P}{\partial \lambda_{4,6}}
\]</div>
<div class="math notranslate nohighlight">
\[
\lambda_{1,4}^{\ell} = \lambda_{1,4}^{\ell - 1} + \eta \cdot \frac{\partial P}{\partial \lambda_{1,4}}
\]</div>
<div class="math notranslate nohighlight">
\[
b_j^{\ell} = b_j^{\ell - 1} + \eta \cdot \frac{\partial P}{\partial b_j}
\]</div>
<ul class="simple">
<li><p>recall, this process of gradient calculation and model parameters, weights and biases, updating is iterated and is known as gradient descent optimization.</p></li>
<li><p>the goal is to explore the loss hypersurface, avoiding and escaping local minimums and ultimately finding the global minimum.</p></li>
<li><p>learning rate, also known as step size is commonly set between 0.0 and 1.0, note 0.01 is the default in Keras module of TensorFlow</p></li>
<li><p><strong>Low Learning Rate</strong> ‚Äì more stable, but a slower solution, may get stuck in a local minimum</p></li>
<li><p><strong>High Learning Rate</strong> ‚Äì may be unstable, but perhaps a faster solution, may diverge out of the global minimum</p></li>
</ul>
<p>One strategy is to start with a high learning rate and then to decrease the learning rate over the iterations</p>
<ul class="simple">
<li><p><strong>Learning Rate Decay</strong> - set as &gt; 0 to avoid mitigate oscillations,</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\eta^{\ell} = \eta^{\ell - 1} \cdot \left( \frac{1}{1 + \text{decay} \cdot \ell} \right)
\]</div>
<p>where <span class="math notranslate nohighlight">\(\ell\)</span> is the model training epoch</p>
<p>Notice that the model parameter updates are for a single training data case? Consider this single model parameter,</p>
<p>we calculate the update over all samples in the batch and apply the average of the updates.</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial P}{\partial \lambda_{4,6}} = H_4 \cdot \frac{\partial P}{\partial O_{6_{\text{in}}}} = 0.42 \cdot 1.00 = 0.42
\]</div>
<p>is applied to update the <span class="math notranslate nohighlight">\(\lambda_{4,6}\)</span> parameter as,</p>
<div class="math notranslate nohighlight">
\[
\lambda_{4,6}^{\ell} = \lambda_{4,6}^{\ell - 1} + \eta \cdot \frac{\partial P}{\partial \lambda_{4,6}}
\]</div>
<p>is dependent on <span class="math notranslate nohighlight">\(H_4\)</span> node output, and <span class="math notranslate nohighlight">\(ùëÉ\)</span> error that are for a single sample, <span class="math notranslate nohighlight">\(ùë•_1,\ldots,ùë•_ùëö\)</span> and <span class="math notranslate nohighlight">\(ùë¶\)</span>; therefore, we cannot calculate a single parameter update over all our <span class="math notranslate nohighlight">\(1,\ldots,n\)</span> training data samples.</p>
<ul class="simple">
<li><p>instead we can calculate <span class="math notranslate nohighlight">\(1,\ldots,n\)</span> updates and then apply the average of all the updates to our model parameters,</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\lambda_{4,6}^{\ell} = \lambda_{4,6}^{\ell - 1} + \frac{1}{n_{batch}} \sum_{i=1}^{n_{batch}} \eta \cdot \frac{\partial P}{\partial \lambda_{4,6}}
\]</div>
<ul class="simple">
<li><p>since the learning rate is a constant, we can move it out of the sum and now we are averaging the gradients,</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\lambda_{4,6}^{\ell} = \lambda_{4,6}^{\ell - 1} + \eta \frac{1}{n_{batch}} \sum_{i=1}^{n_{batch}} \frac{\partial P}{\partial \lambda_{4,6}}
\]</div>
</section>
<section id="training-epochs">
<h2>Training Epochs<a class="headerlink" href="#training-epochs" title="Permalink to this heading">#</a></h2>
<p>This is a good time to talk about stochastic gradient descent optimization, first let‚Äôs define some common terms,</p>
<ul class="simple">
<li><p><strong>Batch Gradient Descent</strong> - updates the model parameters after passing through all of the data</p></li>
<li><p><strong>Stochastic Gradient Descent</strong> - updates the model parameters over each sample data</p></li>
<li><p><strong>Mini-batch Gradient Descent</strong> - updates the model parameter after passing through a single batch</p></li>
</ul>
<p>With mini-batch gradient descent stochasticity is introduced through the use of subsets of the data, known as batches,</p>
<ul class="simple">
<li><p>for example, if we divide our 100 samples into 4 batches, then we iterate over each batch separately</p></li>
<li><p>we speed up the individual updates, fewer data are faster to calculate, but we introduce more error</p></li>
<li><p>this often helps the training explore for the global minimum and avoid getting stuck in local minimums and along ridges in the loss hypersurface</p></li>
</ul>
<p>Finally our last definition here,</p>
<ul class="simple">
<li><p><strong>epoch</strong> - is one pass over all of the data, so that would be 4 iterations of updating the model parameters if we have 4 mini-batches</p></li>
</ul>
<p>There are many other considerations that I will add later including,</p>
<ul class="simple">
<li><p>momentum</p></li>
<li><p>adaptive optimization</p></li>
</ul>
<p>Now let‚Äôs build the above artificial neural network by-hand and visualize the solution!</p>
<ul class="simple">
<li><p>this is by-hand so that you can see every calculation. I intentionally avoided using TensorFlow or PyTorch.</p></li>
</ul>
</section>
<section id="interactive-dashboard">
<h2>Interactive Dashboard<a class="headerlink" href="#interactive-dashboard" title="Permalink to this heading">#</a></h2>
<p>I built out an interactive Python dashboard with the code below for training an artificial neural network. You can step through the training iteration and observe over the training epochs,</p>
<ul class="simple">
<li><p>model parameters</p></li>
<li><p>forward pass predictions</p></li>
<li><p>backpropagation of error derivatives</p></li>
</ul>
<p>If you would like to see artificial neural networks in action, check out my <a class="reference external" href="https://github.com/GeostatsGuy/DataScienceInteractivePython/blob/main/Interactive_ANN.ipynb">ANN interactive Python dashboard</a>,</p>
<figure style="text-align: center;">
  <img src="_static/ANN/interactive_ann.png" style="display: block; margin: 0 auto; width: 70%;">
  <figcaption style="text-align: center;"> Interactive artificial neural network training Python dashboard.
</figcaption>
</figure> 
</section>
<section id="import-required-packages">
<h2>Import Required Packages<a class="headerlink" href="#import-required-packages" title="Permalink to this heading">#</a></h2>
<p>We will also need some standard packages. These should have been installed with Anaconda 3.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib.ticker</span> <span class="kn">import</span> <span class="p">(</span><span class="n">MultipleLocator</span><span class="p">,</span> <span class="n">AutoMinorLocator</span><span class="p">,</span> <span class="n">AutoLocator</span><span class="p">)</span> <span class="c1"># control of axes ticks</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;axes&#39;</span><span class="p">,</span> <span class="n">axisbelow</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>                            <span class="c1"># set axes and grids in the background for all plots</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="n">seed</span> <span class="o">=</span> <span class="mi">13</span>
</pre></div>
</div>
</div>
</div>
<p>If you get a package import error, you may have to first install some of these packages. This can usually be accomplished by opening up a command window on Windows and then typing ‚Äòpython -m pip install [package-name]‚Äô. More assistance is available with the respective package docs.</p>
</section>
<section id="declare-functions">
<h2>Declare Functions<a class="headerlink" href="#declare-functions" title="Permalink to this heading">#</a></h2>
<p>Here‚Äôs the functions to make, train and visualize our artificial neural network.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">add_grid</span><span class="p">():</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span><span class="n">linewidth</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">,</span><span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">)</span> <span class="c1"># add y grids</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span><span class="n">length</span><span class="o">=</span><span class="mi">7</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">AutoMinorLocator</span><span class="p">());</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">AutoMinorLocator</span><span class="p">())</span> <span class="c1"># turn on minor ticks   </span>

<span class="k">def</span> <span class="nf">calculate_angle_rads</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">):</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span>     <span class="c1"># Calculate the differences</span>
    <span class="n">dy</span> <span class="o">=</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span>
    <span class="n">angle_rads</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="n">dy</span><span class="p">,</span> <span class="n">dx</span><span class="p">)</span>    <span class="c1"># Calculate the angle in radians</span>
    <span class="c1">#angle_degrees = math.degrees(angle_radians)    # Convert the angle to degrees</span>
    <span class="k">return</span> <span class="n">angle_rads</span>
    
<span class="k">def</span> <span class="nf">offset</span><span class="p">(</span><span class="n">pto</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> <span class="n">angle_deg</span><span class="p">):</span> <span class="c1"># modified from ChatGPT 4.o generated</span>
    <span class="n">angle_rads</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">angle_deg</span><span class="p">)</span> <span class="c1"># Convert angle from degrees to radians</span>
    <span class="n">x_new</span> <span class="o">=</span> <span class="n">pto</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">distance</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angle_rads</span><span class="p">)</span> <span class="c1"># Calculate the new coordinates</span>
    <span class="n">y_new</span> <span class="o">=</span> <span class="n">pto</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">distance</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angle_rads</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="n">x_new</span><span class="p">,</span> <span class="n">y_new</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">offsetx</span><span class="p">(</span><span class="n">xo</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> <span class="n">angle_deg</span><span class="p">):</span> <span class="c1"># modified from ChatGPT 4.o generated</span>
    <span class="n">angle_rads</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">angle_deg</span><span class="p">)</span> <span class="c1"># Convert angle from degrees to radians</span>
    <span class="n">x_new</span> <span class="o">=</span> <span class="n">xo</span> <span class="o">+</span> <span class="n">distance</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angle_rads</span><span class="p">)</span> <span class="c1"># Calculate the new coordinates</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="n">xo</span><span class="p">,</span> <span class="n">x_new</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">offset_arrx</span><span class="p">(</span><span class="n">xo</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> <span class="n">angle_deg</span><span class="p">,</span><span class="n">size</span><span class="p">):</span> <span class="c1"># modified from ChatGPT 4.o generated</span>
    <span class="n">angle_rads</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">angle_deg</span><span class="p">)</span> <span class="c1"># Convert angle from degrees to radians</span>
    <span class="n">x_new</span> <span class="o">=</span> <span class="n">xo</span> <span class="o">+</span> <span class="n">distance</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angle_rads</span><span class="p">)</span> <span class="c1"># Calculate the new coordinates</span>
    <span class="n">x_arr</span> <span class="o">=</span> <span class="n">x_new</span> <span class="o">+</span> <span class="n">size</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angle_rads</span><span class="o">+</span><span class="mf">2.48</span><span class="p">)</span> <span class="c1"># Calculate the new coordinates</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="n">x_new</span><span class="p">,</span> <span class="n">x_arr</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">offsety</span><span class="p">(</span><span class="n">yo</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> <span class="n">angle_deg</span><span class="p">):</span> <span class="c1"># modified from ChatGPT 4.o generated</span>
    <span class="n">angle_rads</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">angle_deg</span><span class="p">)</span> <span class="c1"># Convert angle from degrees to radians</span>
    <span class="n">y_new</span> <span class="o">=</span> <span class="n">yo</span> <span class="o">+</span> <span class="n">distance</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angle_rads</span><span class="p">)</span> <span class="c1"># Calculate the new coordinates</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="n">yo</span><span class="p">,</span> <span class="n">y_new</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">offset_arry</span><span class="p">(</span><span class="n">yo</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> <span class="n">angle_deg</span><span class="p">,</span><span class="n">size</span><span class="p">):</span> <span class="c1"># modified from ChatGPT 4.o generated</span>
    <span class="n">angle_rads</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">angle_deg</span><span class="p">)</span> <span class="c1"># Convert angle from degrees to radians</span>
    <span class="n">y_new</span> <span class="o">=</span> <span class="n">yo</span> <span class="o">+</span> <span class="n">distance</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angle_rads</span><span class="p">)</span> <span class="c1"># Calculate the new coordinates</span>
    <span class="n">y_arr</span> <span class="o">=</span> <span class="n">y_new</span> <span class="o">+</span> <span class="n">size</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angle_rads</span><span class="o">+</span><span class="mf">2.48</span><span class="p">)</span> <span class="c1"># Calculate the new coordinates</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="n">y_new</span><span class="p">,</span> <span class="n">y_arr</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">lint</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
    <span class="c1"># Calculate the interpolated coordinates</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">+</span> <span class="n">t</span> <span class="o">*</span> <span class="p">(</span><span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">t</span> <span class="o">*</span> <span class="p">(</span><span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">lintx</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
    <span class="c1"># Calculate the interpolated coordinates</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">+</span> <span class="n">t</span> <span class="o">*</span> <span class="p">(</span><span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x</span>

<span class="k">def</span> <span class="nf">linty</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
    <span class="c1"># Calculate the interpolated coordinates</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">t</span> <span class="o">*</span> <span class="p">(</span><span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">y</span>

<span class="k">def</span> <span class="nf">lint_intx</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">ts</span><span class="p">,</span> <span class="n">te</span><span class="p">):</span>
    <span class="c1"># Calculate the interpolated coordinates</span>
    <span class="n">xs</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">+</span> <span class="n">ts</span> <span class="o">*</span> <span class="p">(</span><span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span><span class="p">)</span>
    <span class="n">xe</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">+</span> <span class="n">te</span> <span class="o">*</span> <span class="p">(</span><span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="n">xs</span><span class="p">,</span><span class="n">xe</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">lint_inty</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">ts</span><span class="p">,</span> <span class="n">te</span><span class="p">):</span>
    <span class="c1"># Calculate the interpolated coordinates</span>
    <span class="n">ys</span> <span class="o">=</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">ts</span> <span class="o">*</span> <span class="p">(</span><span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span><span class="p">)</span>
    <span class="n">ye</span> <span class="o">=</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">te</span> <span class="o">*</span> <span class="p">(</span><span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="n">ys</span><span class="p">,</span><span class="n">ye</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">lint_int_arrx</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">ts</span><span class="p">,</span> <span class="n">te</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
    <span class="c1"># Calculate the interpolated coordinates</span>
    <span class="n">xe</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">+</span> <span class="n">te</span> <span class="o">*</span> <span class="p">(</span><span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span><span class="p">)</span>
    <span class="n">line_angle_rads</span> <span class="o">=</span> <span class="n">calculate_angle_rads</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">)</span>
    <span class="n">x_arr</span> <span class="o">=</span> <span class="n">xe</span> <span class="o">+</span> <span class="n">size</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">line_angle_rads</span><span class="o">+</span><span class="mf">2.48</span><span class="p">)</span> <span class="c1"># Calculate the new coordinates</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="n">xe</span><span class="p">,</span><span class="n">x_arr</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">lint_int_arry</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">ts</span><span class="p">,</span> <span class="n">te</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
    <span class="c1"># Calculate the interpolated coordinates</span>
    <span class="n">ye</span> <span class="o">=</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">te</span> <span class="o">*</span> <span class="p">(</span><span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span><span class="p">)</span>
    <span class="n">line_angle_rads</span> <span class="o">=</span> <span class="n">calculate_angle_rads</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">)</span>
    <span class="n">y_arr</span> <span class="o">=</span> <span class="n">ye</span> <span class="o">+</span> <span class="n">size</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">line_angle_rads</span><span class="o">+</span><span class="mf">2.48</span><span class="p">)</span> <span class="c1"># Calculate the new coordinates</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="n">ye</span><span class="p">,</span><span class="n">y_arr</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">as_si</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ndp</span><span class="p">):</span> <span class="c1"># from xnx on StackOverflow https://stackoverflow.com/questions/31453422/displaying-numbers-with-x-instead-of-e-scientific-notation-in-matplotlib </span>
    <span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;{x:0.</span><span class="si">{ndp:d}</span><span class="s1">e}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">ndp</span><span class="o">=</span><span class="n">ndp</span><span class="p">)</span>
    <span class="n">m</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;e&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="sa">r</span><span class="s1">&#39;</span><span class="si">{m:s}</span><span class="s1">\times 10^{{</span><span class="si">{e:d}</span><span class="s1">}}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="n">m</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="the-simple-ann">
<h2>The Simple ANN<a class="headerlink" href="#the-simple-ann" title="Permalink to this heading">#</a></h2>
<p>I wrote this code to specify a simple ANN:</p>
<ul class="simple">
<li><p>three input nodes, 2 hidden nodes and 1 output node</p></li>
</ul>
<p>and to train the ANN by iteratively performing the forward calculation and backpropagation. I calculate:</p>
<ul class="simple">
<li><p>the error and then propagate it to each node</p></li>
<li><p>solve for the partial derivatives of the error with respect to each weight and bias</p></li>
</ul>
<p>all weights, biases and partial derivatives for all epoch are recorded in vectors for plotting</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x1</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">;</span> <span class="n">x2</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">;</span> <span class="n">x3</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">;</span> <span class="n">y</span> <span class="o">=</span> <span class="mf">0.3</span> <span class="c1"># training data</span>
<span class="n">lr</span> <span class="o">=</span> <span class="mf">0.2</span> <span class="c1"># learning rate</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>

<span class="n">nepoch</span> <span class="o">=</span> <span class="mi">1000</span>

<span class="n">y4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nepoch</span><span class="p">);</span> <span class="n">y5</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nepoch</span><span class="p">);</span> <span class="n">y6</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nepoch</span><span class="p">)</span>

<span class="n">w14</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nepoch</span><span class="p">);</span> <span class="n">w24</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nepoch</span><span class="p">);</span> <span class="n">w34</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nepoch</span><span class="p">)</span>
<span class="n">w15</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nepoch</span><span class="p">);</span> <span class="n">w25</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nepoch</span><span class="p">);</span> <span class="n">w35</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nepoch</span><span class="p">)</span>
<span class="n">w46</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nepoch</span><span class="p">);</span> <span class="n">w56</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nepoch</span><span class="p">)</span>

<span class="n">dw14</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nepoch</span><span class="p">);</span> <span class="n">dw24</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nepoch</span><span class="p">);</span> <span class="n">dw34</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nepoch</span><span class="p">)</span>
<span class="n">dw15</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nepoch</span><span class="p">);</span> <span class="n">dw25</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nepoch</span><span class="p">);</span> <span class="n">dw35</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nepoch</span><span class="p">)</span>
<span class="n">dw46</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nepoch</span><span class="p">);</span> <span class="n">dw56</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nepoch</span><span class="p">)</span>

<span class="n">db4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nepoch</span><span class="p">);</span> <span class="n">db5</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nepoch</span><span class="p">);</span> <span class="n">db6</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nepoch</span><span class="p">)</span>

<span class="n">b4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nepoch</span><span class="p">);</span> <span class="n">b5</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nepoch</span><span class="p">);</span> <span class="n">b6</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nepoch</span><span class="p">)</span>
<span class="n">y4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nepoch</span><span class="p">);</span> <span class="n">y5</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nepoch</span><span class="p">);</span> <span class="n">y6</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nepoch</span><span class="p">)</span>
<span class="n">d4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nepoch</span><span class="p">);</span> <span class="n">d5</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nepoch</span><span class="p">);</span> <span class="n">d6</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nepoch</span><span class="p">)</span>

<span class="c1"># initialize the weights - Xavier Weight Initialization </span>
<span class="n">lower</span><span class="p">,</span> <span class="n">upper</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)),</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">3.0</span><span class="p">))</span> <span class="c1"># lower and upper bound for the weights, uses inputs to node</span>
<span class="c1">#lower, upper = -(sqrt(6.0) / sqrt(3.0 + 2.0)), (sqrt(6.0) / sqrt(3.0 + 2.0)) # Normalized Xavier weights, integrates ouputs also</span>
<span class="n">w14</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">lower</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">*</span> <span class="p">(</span><span class="n">upper</span> <span class="o">-</span> <span class="n">lower</span><span class="p">);</span> 
<span class="n">w24</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">lower</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">*</span> <span class="p">(</span><span class="n">upper</span> <span class="o">-</span> <span class="n">lower</span><span class="p">);</span> 
<span class="n">w34</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">lower</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">*</span> <span class="p">(</span><span class="n">upper</span> <span class="o">-</span> <span class="n">lower</span><span class="p">);</span>
<span class="n">w15</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">lower</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">*</span> <span class="p">(</span><span class="n">upper</span> <span class="o">-</span> <span class="n">lower</span><span class="p">);</span> 
<span class="n">w25</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">lower</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">*</span> <span class="p">(</span><span class="n">upper</span> <span class="o">-</span> <span class="n">lower</span><span class="p">);</span> 
<span class="n">w35</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">lower</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">*</span> <span class="p">(</span><span class="n">upper</span> <span class="o">-</span> <span class="n">lower</span><span class="p">);</span>

<span class="n">lower</span><span class="p">,</span> <span class="n">upper</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)),</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">2.0</span><span class="p">))</span>
<span class="c1">#lower, upper = -(sqrt(6.0) / sqrt(2.0 + 1.0)), (sqrt(6.0) / sqrt(2.0 + 1.0)) # Normalized Xavier weights, integrates ouputs also</span>

<span class="n">w46</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">lower</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">*</span> <span class="p">(</span><span class="n">upper</span> <span class="o">-</span> <span class="n">lower</span><span class="p">);</span> 
<span class="n">w56</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">lower</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">*</span> <span class="p">(</span><span class="n">upper</span> <span class="o">-</span> <span class="n">lower</span><span class="p">);</span>     

<span class="c1">#b4[0] = np.random.random(); b5[0] = np.random.random(); b6[0] = np.random.random()</span>
<span class="n">b4</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="mf">0.5</span><span class="p">;</span> <span class="n">b5</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="mf">0.5</span><span class="p">;</span> <span class="n">b6</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="mf">0.5</span><span class="p">;</span> <span class="c1"># small random value    </span>


<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nepoch</span><span class="p">):</span>

<span class="c1"># forward pass of model</span>
    <span class="n">y4</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">w14</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">x1</span> <span class="o">+</span> <span class="n">w24</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">x2</span> <span class="o">+</span> <span class="n">w34</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">x3</span> <span class="o">+</span> <span class="n">b4</span><span class="p">[</span><span class="n">i</span><span class="p">];</span> 
    <span class="n">y4</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">y4</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
    
    <span class="n">y5</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">w15</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">x1</span> <span class="o">+</span> <span class="n">w25</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">x2</span> <span class="o">+</span> <span class="n">w35</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">x3</span> <span class="o">+</span> <span class="n">b5</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">y5</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">y5</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
    
    <span class="n">y6</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">w46</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">y4</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">w56</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">y5</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">b6</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="c1">#    y6[i] = 1.0/(1 + math.exp(-1*y6[i])) # sgimoid / logistic activation at o6 </span>

<span class="c1"># back propagate the error through the nodes</span>
<span class="c1">#    d6[i] = y6[i]*(1-y6[i])*(y-y6[i]) # sgimoid / logistic activation at o6 </span>
    <span class="n">d6</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">y6</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="c1"># identity activation o at o6</span>
    <span class="n">d5</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">y5</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">y5</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">*</span><span class="n">w56</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">d6</span><span class="p">[</span><span class="n">i</span><span class="p">];</span> <span class="n">d4</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">y4</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">y4</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">*</span><span class="n">w46</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">d6</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

<span class="c1"># calculate the change in weights</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nepoch</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">dw14</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">lr</span><span class="o">*</span><span class="n">d4</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">x1</span><span class="p">;</span> <span class="n">dw24</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">lr</span><span class="o">*</span><span class="n">d4</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">x2</span><span class="p">;</span> <span class="n">dw34</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">lr</span><span class="o">*</span><span class="n">d4</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">x3</span>
        <span class="n">dw15</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">lr</span><span class="o">*</span><span class="n">d5</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">x1</span><span class="p">;</span> <span class="n">dw25</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">lr</span><span class="o">*</span><span class="n">d5</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">x2</span><span class="p">;</span> <span class="n">dw35</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">lr</span><span class="o">*</span><span class="n">d5</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">x3</span>
        <span class="n">dw46</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">lr</span><span class="o">*</span><span class="n">d6</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">y4</span><span class="p">[</span><span class="n">i</span><span class="p">];</span> <span class="n">dw56</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">lr</span><span class="o">*</span><span class="n">d6</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">y5</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> 
        
        <span class="n">db4</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">lr</span><span class="o">*</span><span class="n">d4</span><span class="p">[</span><span class="n">i</span><span class="p">];</span> <span class="n">db5</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">lr</span><span class="o">*</span><span class="n">d5</span><span class="p">[</span><span class="n">i</span><span class="p">];</span> <span class="n">db6</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">lr</span><span class="o">*</span><span class="n">d6</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>

        <span class="n">w14</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">w14</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">dw14</span><span class="p">[</span><span class="n">i</span><span class="p">];</span> <span class="n">w24</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">w24</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">dw24</span><span class="p">[</span><span class="n">i</span><span class="p">];</span> <span class="n">w34</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">w34</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">dw34</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> 
        <span class="n">w15</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">w15</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">dw15</span><span class="p">[</span><span class="n">i</span><span class="p">];</span> <span class="n">w25</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">w25</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">dw25</span><span class="p">[</span><span class="n">i</span><span class="p">];</span> <span class="n">w35</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">w35</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">dw35</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> 
        <span class="n">w46</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">w46</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">dw46</span><span class="p">[</span><span class="n">i</span><span class="p">];</span> <span class="n">w56</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">w56</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">dw56</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

        <span class="n">b4</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">b4</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">db4</span><span class="p">[</span><span class="n">i</span><span class="p">];</span> <span class="n">b5</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">b5</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">db5</span><span class="p">[</span><span class="n">i</span><span class="p">];</span> <span class="n">b6</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">b6</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">db6</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> 
</pre></div>
</div>
</div>
</div>
</section>
<section id="now-visualize-the-network-for-a-specific-epoch">
<h2>Now Visualize the Network for a Specific Epoch<a class="headerlink" href="#now-visualize-the-network-for-a-specific-epoch" title="Permalink to this heading">#</a></h2>
<p>I wrote a custom network visualization below, select iepoch and visualize the artificial neural network for a specific epoch.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iepoch</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">dx</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.19</span><span class="p">;</span> <span class="n">dy</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.09</span><span class="p">;</span> <span class="n">edge</span> <span class="o">=</span> <span class="mf">1.0</span>

<span class="n">o6x</span> <span class="o">=</span> <span class="mi">17</span><span class="p">;</span> <span class="n">o6y</span> <span class="o">=</span><span class="mi">5</span><span class="p">;</span> <span class="n">h5x</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span> <span class="n">h5y</span> <span class="o">=</span> <span class="mf">3.5</span><span class="p">;</span> <span class="n">h4x</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span> <span class="n">h4y</span> <span class="o">=</span> <span class="mf">6.5</span>
<span class="n">i1x</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span> <span class="n">i1y</span> <span class="o">=</span> <span class="mf">9.0</span><span class="p">;</span> <span class="n">i2x</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span> <span class="n">i2y</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span> <span class="n">i3x</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span> <span class="n">i3y</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">;</span> <span class="n">buffer</span> <span class="o">=</span> <span class="mf">0.5</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>

<span class="n">circle_i1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Circle</span><span class="p">((</span><span class="n">i1x</span><span class="p">,</span><span class="n">i1y</span><span class="p">),</span> <span class="mf">0.25</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">100</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39; $I_1$&#39;</span><span class="p">,(</span><span class="n">i1x</span><span class="o">+</span><span class="n">dx</span><span class="p">,</span><span class="n">i1y</span><span class="o">+</span><span class="n">dy</span><span class="p">),</span><span class="n">zorder</span><span class="o">=</span><span class="mi">100</span><span class="p">);</span> 
<span class="n">circle_i1b</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Circle</span><span class="p">((</span><span class="n">i1x</span><span class="p">,</span><span class="n">i1y</span><span class="p">),</span> <span class="mf">0.40</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">facecolor</span> <span class="o">=</span> <span class="s1">&#39;white&#39;</span><span class="p">,</span><span class="n">edgecolor</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">circle_i1</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">circle_i1b</span><span class="p">)</span>

<span class="n">circle_i2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Circle</span><span class="p">((</span><span class="n">i2x</span><span class="p">,</span><span class="n">i2y</span><span class="p">),</span> <span class="mf">0.25</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">100</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39; $I_2$&#39;</span><span class="p">,(</span><span class="n">i2x</span><span class="o">+</span><span class="n">dx</span><span class="p">,</span><span class="n">i2y</span><span class="o">+</span><span class="n">dy</span><span class="p">),</span><span class="n">zorder</span><span class="o">=</span><span class="mi">100</span><span class="p">);</span> 
<span class="n">circle_i2b</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Circle</span><span class="p">((</span><span class="n">i2x</span><span class="p">,</span><span class="n">i2y</span><span class="p">),</span> <span class="mf">0.40</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">facecolor</span> <span class="o">=</span> <span class="s1">&#39;white&#39;</span><span class="p">,</span><span class="n">edgecolor</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">circle_i2</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">circle_i2b</span><span class="p">)</span>

<span class="n">circle_i3</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Circle</span><span class="p">((</span><span class="n">i3x</span><span class="p">,</span><span class="n">i3y</span><span class="p">),</span> <span class="mf">0.25</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">100</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39; $I_3$&#39;</span><span class="p">,(</span><span class="n">i3x</span><span class="o">+</span><span class="n">dx</span><span class="p">,</span><span class="n">i3y</span><span class="o">+</span><span class="n">dy</span><span class="p">),</span><span class="n">zorder</span><span class="o">=</span><span class="mi">100</span><span class="p">);</span> 
<span class="n">circle_i3b</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Circle</span><span class="p">((</span><span class="n">i3x</span><span class="p">,</span><span class="n">i3y</span><span class="p">),</span> <span class="mf">0.40</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">facecolor</span> <span class="o">=</span> <span class="s1">&#39;white&#39;</span><span class="p">,</span><span class="n">edgecolor</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">circle_i3</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">circle_i3b</span><span class="p">)</span>

<span class="n">circle_h4</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Circle</span><span class="p">((</span><span class="n">h4x</span><span class="p">,</span><span class="n">h4y</span><span class="p">),</span> <span class="mf">0.25</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">100</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$H_4$&#39;</span><span class="p">,(</span><span class="n">h4x</span><span class="o">+</span><span class="n">dx</span><span class="p">,</span><span class="n">h4y</span><span class="o">+</span><span class="n">dy</span><span class="p">),</span><span class="n">zorder</span><span class="o">=</span><span class="mi">100</span><span class="p">);</span> 
<span class="n">circle_h4b</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Circle</span><span class="p">((</span><span class="n">h4x</span><span class="p">,</span><span class="n">h4y</span><span class="p">),</span> <span class="mf">0.40</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">facecolor</span> <span class="o">=</span> <span class="s1">&#39;white&#39;</span><span class="p">,</span><span class="n">edgecolor</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">circle_h4</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">circle_h4b</span><span class="p">)</span>

<span class="n">circle_h5</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Circle</span><span class="p">((</span><span class="n">h5x</span><span class="p">,</span><span class="n">h5y</span><span class="p">),</span> <span class="mf">0.25</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">100</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$H_5$&#39;</span><span class="p">,(</span><span class="n">h5x</span><span class="o">+</span><span class="n">dx</span><span class="p">,</span><span class="n">h5y</span><span class="o">+</span><span class="n">dy</span><span class="p">),</span><span class="n">zorder</span><span class="o">=</span><span class="mi">100</span><span class="p">);</span> 
<span class="n">circle_h5b</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Circle</span><span class="p">((</span><span class="n">h5x</span><span class="p">,</span><span class="n">h5y</span><span class="p">),</span> <span class="mf">0.40</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">facecolor</span> <span class="o">=</span> <span class="s1">&#39;white&#39;</span><span class="p">,</span><span class="n">edgecolor</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">circle_h5</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">circle_h5b</span><span class="p">)</span>

<span class="n">circle_o6</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Circle</span><span class="p">((</span><span class="n">o6x</span><span class="p">,</span><span class="n">o6y</span><span class="p">),</span> <span class="mf">0.25</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">100</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$O_6$&#39;</span><span class="p">,(</span><span class="n">o6x</span><span class="o">+</span><span class="n">dx</span><span class="p">,</span><span class="n">o6y</span><span class="o">+</span><span class="n">dy</span><span class="p">),</span><span class="n">zorder</span><span class="o">=</span><span class="mi">100</span><span class="p">);</span> 
<span class="n">circle_o6b</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Circle</span><span class="p">((</span><span class="n">o6x</span><span class="p">,</span><span class="n">o6y</span><span class="p">),</span> <span class="mf">0.40</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">facecolor</span> <span class="o">=</span> <span class="s1">&#39;white&#39;</span><span class="p">,</span><span class="n">edgecolor</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">circle_o6</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">circle_o6b</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">i1x</span><span class="o">-</span><span class="n">edge</span><span class="p">,</span><span class="n">i1x</span><span class="p">],[</span><span class="n">i1y</span><span class="p">,</span><span class="n">i1y</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">i2x</span><span class="o">-</span><span class="n">edge</span><span class="p">,</span><span class="n">i2x</span><span class="p">],[</span><span class="n">i2y</span><span class="p">,</span><span class="n">i2y</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">i3x</span><span class="o">-</span><span class="n">edge</span><span class="p">,</span><span class="n">i3x</span><span class="p">],[</span><span class="n">i3y</span><span class="p">,</span><span class="n">i3y</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$x_1$ = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="mi">2</span><span class="p">)),(</span><span class="n">i1x</span><span class="o">-</span><span class="n">buffer</span><span class="o">-</span><span class="mf">1.6</span><span class="p">,</span><span class="n">i1y</span><span class="o">-</span><span class="mf">0.05</span><span class="p">),</span><span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span>
             <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round,pad=0.0&quot;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">),</span><span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$x_2$ = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span><span class="mi">2</span><span class="p">)),(</span><span class="n">i2x</span><span class="o">-</span><span class="n">buffer</span><span class="o">-</span><span class="mf">1.6</span><span class="p">,</span><span class="n">i2y</span><span class="o">-</span><span class="mf">0.05</span><span class="p">),</span><span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span>
             <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round,pad=0.0&quot;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">),</span><span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$x_3$ = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">x3</span><span class="p">,</span><span class="mi">2</span><span class="p">)),(</span><span class="n">i3x</span><span class="o">-</span><span class="n">buffer</span><span class="o">-</span><span class="mf">1.6</span><span class="p">,</span><span class="n">i3y</span><span class="o">-</span><span class="mf">0.05</span><span class="p">),</span><span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span>
             <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round,pad=0.0&quot;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">),</span><span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> 

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">i1x</span><span class="p">,</span><span class="n">h4x</span><span class="p">],[</span><span class="n">i1y</span><span class="p">,</span><span class="n">h4y</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightcoral&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">i2x</span><span class="p">,</span><span class="n">h4x</span><span class="p">],[</span><span class="n">i2y</span><span class="p">,</span><span class="n">h4y</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">i3x</span><span class="p">,</span><span class="n">h4x</span><span class="p">],[</span><span class="n">i3y</span><span class="p">,</span><span class="n">h4y</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkred&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">i1x</span><span class="p">,</span><span class="n">h5x</span><span class="p">],[</span><span class="n">i1y</span><span class="p">,</span><span class="n">h5y</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">i2x</span><span class="p">,</span><span class="n">h5x</span><span class="p">],[</span><span class="n">i2y</span><span class="p">,</span><span class="n">h5y</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">i3x</span><span class="p">,</span><span class="n">h5x</span><span class="p">],[</span><span class="n">i3y</span><span class="p">,</span><span class="n">h5y</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkblue&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">h4x</span><span class="p">,</span><span class="n">o6x</span><span class="p">],[</span><span class="n">h4y</span><span class="p">,</span><span class="n">o6y</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">h5x</span><span class="p">,</span><span class="n">o6x</span><span class="p">],[</span><span class="n">h5y</span><span class="p">,</span><span class="n">o6y</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkorange&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">o6x</span><span class="o">+</span><span class="n">edge</span><span class="p">,</span><span class="n">o6x</span><span class="p">],[</span><span class="n">o6y</span><span class="p">,</span><span class="n">o6y</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\hat</span><span class="si">{y}</span><span class="s1">$ = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">y6</span><span class="p">[</span><span class="n">iepoch</span><span class="p">],</span><span class="mi">2</span><span class="p">)),(</span><span class="n">o6x</span><span class="o">+</span><span class="n">buffer</span><span class="o">+</span><span class="mf">0.7</span><span class="p">,</span><span class="n">o6y</span><span class="o">-</span><span class="mf">0.05</span><span class="p">),</span><span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span>
             <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round,pad=0.0&quot;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">),</span><span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> 

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">offsetx</span><span class="p">(</span><span class="n">h4x</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">12</span><span class="p">),</span><span class="n">offsety</span><span class="p">(</span><span class="n">h4y</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">12</span><span class="p">)</span><span class="o">+</span><span class="mf">0.1</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">offset_arrx</span><span class="p">(</span><span class="n">h4x</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">12</span><span class="p">,</span><span class="mf">0.2</span><span class="p">),</span><span class="n">offset_arry</span><span class="p">(</span><span class="n">h4y</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">12</span><span class="p">,</span><span class="mf">0.2</span><span class="p">)</span><span class="o">+</span><span class="mf">0.1</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$H_</span><span class="si">{4}</span><span class="s1">$ = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">y4</span><span class="p">[</span><span class="n">iepoch</span><span class="p">],</span><span class="mi">2</span><span class="p">)),(</span><span class="n">lintx</span><span class="p">(</span><span class="n">h4x</span><span class="p">,</span><span class="n">h4y</span><span class="p">,</span><span class="n">o6x</span><span class="p">,</span><span class="n">o6y</span><span class="p">,</span><span class="mf">0.08</span><span class="p">),</span><span class="n">linty</span><span class="p">(</span><span class="n">h4x</span><span class="p">,</span><span class="n">h4y</span><span class="p">,</span><span class="n">o6x</span><span class="p">,</span><span class="n">o6y</span><span class="p">,</span><span class="mf">0.08</span><span class="p">)</span><span class="o">-</span><span class="mf">0.0</span><span class="p">),</span><span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span>
             <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round,pad=0.0&quot;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">),</span><span class="n">rotation</span><span class="o">=-</span><span class="mi">12</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">offsetx</span><span class="p">(</span><span class="n">h5x</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">12</span><span class="p">),</span><span class="n">offsety</span><span class="p">(</span><span class="n">h5y</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span><span class="o">+</span><span class="mf">0.1</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkorange&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">offset_arrx</span><span class="p">(</span><span class="n">h5x</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mf">0.2</span><span class="p">),</span><span class="n">offset_arry</span><span class="p">(</span><span class="n">h5y</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mf">0.2</span><span class="p">)</span><span class="o">+</span><span class="mf">0.1</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkorange&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$H_</span><span class="si">{5}</span><span class="s1">$ = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">y5</span><span class="p">[</span><span class="n">iepoch</span><span class="p">],</span><span class="mi">2</span><span class="p">)),(</span><span class="n">lintx</span><span class="p">(</span><span class="n">h5x</span><span class="p">,</span><span class="n">h5y</span><span class="p">,</span><span class="n">o6x</span><span class="p">,</span><span class="n">o6y</span><span class="p">,</span><span class="mf">0.07</span><span class="p">),</span><span class="n">linty</span><span class="p">(</span><span class="n">h5x</span><span class="p">,</span><span class="n">h5y</span><span class="p">,</span><span class="n">o6x</span><span class="p">,</span><span class="n">o6y</span><span class="p">,</span><span class="mf">0.07</span><span class="p">)</span><span class="o">+</span><span class="mf">0.25</span><span class="p">),</span><span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkorange&#39;</span><span class="p">,</span>
             <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round,pad=0.0&quot;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">),</span><span class="n">rotation</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\frac{\partial P}{\partial O_{6_</span><span class="si">{in}</span><span class="s1">}}$ = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">d6</span><span class="p">[</span><span class="n">iepoch</span><span class="p">],</span><span class="mi">2</span><span class="p">)),(</span><span class="n">o6x</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="n">o6y</span><span class="o">-</span><span class="mf">0.7</span><span class="p">),</span><span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\frac{\partial P}{\partial H_{4_</span><span class="si">{in}</span><span class="s1">}}$ = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">d4</span><span class="p">[</span><span class="n">iepoch</span><span class="p">],</span><span class="mi">2</span><span class="p">)),(</span><span class="n">h4x</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="n">h4y</span><span class="o">-</span><span class="mf">0.7</span><span class="p">),</span><span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\frac{\partial P}{\partial H_{5_</span><span class="si">{in}</span><span class="s1">}}$ = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">d5</span><span class="p">[</span><span class="n">iepoch</span><span class="p">],</span><span class="mi">2</span><span class="p">)),(</span><span class="n">h5x</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="n">h5y</span><span class="o">-</span><span class="mf">0.7</span><span class="p">),</span><span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\frac{\partial P}{\partial \hat</span><span class="si">{y}</span><span class="s1">}$ = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">d6</span><span class="p">[</span><span class="n">iepoch</span><span class="p">],</span><span class="mi">2</span><span class="p">)),(</span><span class="n">o6x</span><span class="p">,</span><span class="n">o6y</span><span class="o">-</span><span class="mf">1.2</span><span class="p">),</span><span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\frac{\partial P}{\partial H_{4_</span><span class="si">{out}</span><span class="s1">}}$ = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">w46</span><span class="p">[</span><span class="n">iepoch</span><span class="p">]</span><span class="o">*</span><span class="n">d6</span><span class="p">[</span><span class="n">iepoch</span><span class="p">],</span><span class="mi">2</span><span class="p">)),(</span><span class="n">h4x</span><span class="p">,</span><span class="n">h4y</span><span class="o">-</span><span class="mf">1.2</span><span class="p">),</span><span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\frac{\partial P}{\partial H_{5_</span><span class="si">{out}</span><span class="s1">}}$ = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">w56</span><span class="p">[</span><span class="n">iepoch</span><span class="p">]</span><span class="o">*</span><span class="n">d6</span><span class="p">[</span><span class="n">iepoch</span><span class="p">],</span><span class="mi">2</span><span class="p">)),(</span><span class="n">h5x</span><span class="p">,</span><span class="n">h5y</span><span class="o">-</span><span class="mf">1.2</span><span class="p">),</span><span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lint_intx</span><span class="p">(</span><span class="n">h4x</span><span class="p">,</span> <span class="n">h4y</span><span class="p">,</span> <span class="n">o6x</span><span class="p">,</span> <span class="n">o6y</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.6</span><span class="p">),</span><span class="n">lint_inty</span><span class="p">(</span><span class="n">h4x</span><span class="p">,</span><span class="n">h4y</span><span class="p">,</span><span class="n">o6x</span><span class="p">,</span><span class="n">o6y</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.6</span><span class="p">)</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lint_int_arrx</span><span class="p">(</span><span class="n">o6x</span><span class="p">,</span><span class="n">o6y</span><span class="p">,</span><span class="n">h4x</span><span class="p">,</span><span class="n">h4y</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.2</span><span class="p">),</span><span class="n">lint_int_arry</span><span class="p">(</span><span class="n">o6x</span><span class="p">,</span><span class="n">o6y</span><span class="p">,</span><span class="n">h4x</span><span class="p">,</span><span class="n">h4y</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.2</span><span class="p">)</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\frac{\partial P}{\partial \lambda_{4,6}}$ = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">dw46</span><span class="p">[</span><span class="n">iepoch</span><span class="p">]</span><span class="o">/</span><span class="n">lr</span><span class="p">,</span><span class="mi">4</span><span class="p">)),(</span><span class="n">lintx</span><span class="p">(</span><span class="n">h4x</span><span class="p">,</span><span class="n">h4y</span><span class="p">,</span><span class="n">o6x</span><span class="p">,</span><span class="n">o6y</span><span class="p">,</span><span class="mf">0.5</span><span class="p">)</span><span class="o">-</span><span class="mf">0.6</span><span class="p">,</span><span class="n">linty</span><span class="p">(</span><span class="n">h4x</span><span class="p">,</span><span class="n">h4y</span><span class="p">,</span><span class="n">o6x</span><span class="p">,</span><span class="n">o6y</span><span class="p">,</span><span class="mf">0.5</span><span class="p">)</span><span class="o">-</span><span class="mf">0.72</span><span class="p">),</span><span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span>
              <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round,pad=0.0&quot;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">),</span><span class="n">rotation</span><span class="o">=-</span><span class="mi">11</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lint_intx</span><span class="p">(</span><span class="n">h5x</span><span class="p">,</span> <span class="n">h5y</span><span class="p">,</span> <span class="n">o6x</span><span class="p">,</span> <span class="n">o6y</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.6</span><span class="p">),</span><span class="n">lint_inty</span><span class="p">(</span><span class="n">h5x</span><span class="p">,</span><span class="n">h5y</span><span class="p">,</span><span class="n">o6x</span><span class="p">,</span><span class="n">o6y</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.6</span><span class="p">)</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkorange&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lint_int_arrx</span><span class="p">(</span><span class="n">o6x</span><span class="p">,</span><span class="n">o6y</span><span class="p">,</span><span class="n">h5x</span><span class="p">,</span><span class="n">h5y</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.2</span><span class="p">),</span><span class="n">lint_int_arry</span><span class="p">(</span><span class="n">o6x</span><span class="p">,</span><span class="n">o6y</span><span class="p">,</span><span class="n">h5x</span><span class="p">,</span><span class="n">h5y</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.2</span><span class="p">)</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkorange&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\frac{\partial P}{\partial \lambda_{5,6}}$ = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">dw56</span><span class="p">[</span><span class="n">iepoch</span><span class="p">]</span><span class="o">/</span><span class="n">lr</span><span class="p">,</span><span class="mi">4</span><span class="p">)),(</span><span class="n">lintx</span><span class="p">(</span><span class="n">h5x</span><span class="p">,</span><span class="n">h5y</span><span class="p">,</span><span class="n">o6x</span><span class="p">,</span><span class="n">o6y</span><span class="p">,</span><span class="mf">0.5</span><span class="p">)</span><span class="o">-</span><span class="mf">0.4</span><span class="p">,</span><span class="n">linty</span><span class="p">(</span><span class="n">h5x</span><span class="p">,</span><span class="n">h5y</span><span class="p">,</span><span class="n">o6x</span><span class="p">,</span><span class="n">o6y</span><span class="p">,</span><span class="mf">0.5</span><span class="p">)</span><span class="o">-</span><span class="mf">0.6</span><span class="p">),</span><span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkorange&#39;</span><span class="p">,</span>
              <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round,pad=0.0&quot;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">),</span><span class="n">rotation</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">offsetx</span><span class="p">(</span><span class="n">i1x</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">20</span><span class="p">),</span><span class="n">offsety</span><span class="p">(</span><span class="n">i1y</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">20</span><span class="p">)</span><span class="o">+</span><span class="mf">0.1</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightcoral&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">offset_arrx</span><span class="p">(</span><span class="n">i1x</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span><span class="mf">0.2</span><span class="p">),</span><span class="n">offset_arry</span><span class="p">(</span><span class="n">i1y</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span><span class="mf">0.2</span><span class="p">)</span><span class="o">+</span><span class="mf">0.1</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightcoral&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$I_</span><span class="si">{1}</span><span class="s1">$ = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="mi">2</span><span class="p">)),(</span><span class="n">lintx</span><span class="p">(</span><span class="n">i1x</span><span class="p">,</span><span class="n">i1y</span><span class="p">,</span><span class="n">h4x</span><span class="p">,</span><span class="n">h4y</span><span class="p">,</span><span class="mf">0.1</span><span class="p">),</span><span class="n">linty</span><span class="p">(</span><span class="n">i1x</span><span class="p">,</span><span class="n">i1y</span><span class="p">,</span><span class="n">h4x</span><span class="p">,</span><span class="n">h4y</span><span class="p">,</span><span class="mf">0.1</span><span class="p">)),</span><span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightcoral&#39;</span><span class="p">,</span>
             <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round,pad=0.0&quot;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">),</span><span class="n">rotation</span><span class="o">=-</span><span class="mi">20</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">offsetx</span><span class="p">(</span><span class="n">i2x</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">12</span><span class="p">),</span><span class="n">offsety</span><span class="p">(</span><span class="n">i2y</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span><span class="o">+</span><span class="mf">0.1</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">offset_arrx</span><span class="p">(</span><span class="n">i2x</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mf">0.2</span><span class="p">),</span><span class="n">offset_arry</span><span class="p">(</span><span class="n">i2y</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mf">0.2</span><span class="p">)</span><span class="o">+</span><span class="mf">0.1</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$I_</span><span class="si">{2}</span><span class="s1">$ = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span><span class="mi">2</span><span class="p">)),(</span><span class="n">lintx</span><span class="p">(</span><span class="n">i2x</span><span class="p">,</span><span class="n">i2y</span><span class="p">,</span><span class="n">h4x</span><span class="p">,</span><span class="n">h4y</span><span class="p">,</span><span class="mf">0.1</span><span class="p">),</span><span class="n">linty</span><span class="p">(</span><span class="n">i2x</span><span class="p">,</span><span class="n">i2y</span><span class="p">,</span><span class="n">h4x</span><span class="p">,</span><span class="n">h4y</span><span class="p">,</span><span class="mf">0.1</span><span class="p">)</span><span class="o">+</span><span class="mf">0.22</span><span class="p">),</span><span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>
             <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round,pad=0.0&quot;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">),</span><span class="n">rotation</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">offsetx</span><span class="p">(</span><span class="n">i3x</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">38</span><span class="p">),</span><span class="n">offsety</span><span class="p">(</span><span class="n">i3y</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">38</span><span class="p">)</span><span class="o">+</span><span class="mf">0.1</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkred&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">offset_arrx</span><span class="p">(</span><span class="n">i3x</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">38</span><span class="p">,</span><span class="mf">0.2</span><span class="p">),</span><span class="n">offset_arry</span><span class="p">(</span><span class="n">i3y</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">38</span><span class="p">,</span><span class="mf">0.2</span><span class="p">)</span><span class="o">+</span><span class="mf">0.1</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkred&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$I_</span><span class="si">{3}</span><span class="s1">$ = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">x3</span><span class="p">,</span><span class="mi">2</span><span class="p">)),(</span><span class="n">lintx</span><span class="p">(</span><span class="n">i3x</span><span class="p">,</span><span class="n">i3y</span><span class="p">,</span><span class="n">h4x</span><span class="p">,</span><span class="n">h4y</span><span class="p">,</span><span class="mf">0.08</span><span class="p">)</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span><span class="n">linty</span><span class="p">(</span><span class="n">i3x</span><span class="p">,</span><span class="n">i3y</span><span class="p">,</span><span class="n">h4x</span><span class="p">,</span><span class="n">h4y</span><span class="p">,</span><span class="mf">0.08</span><span class="p">)</span><span class="o">+</span><span class="mf">0.2</span><span class="p">),</span><span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkred&#39;</span><span class="p">,</span>
             <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round,pad=0.0&quot;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">),</span><span class="n">rotation</span><span class="o">=</span><span class="mi">38</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\lambda_{1,4}$ = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">w14</span><span class="p">[</span><span class="n">iepoch</span><span class="p">],</span><span class="mi">2</span><span class="p">)),((</span><span class="n">i1x</span><span class="o">+</span><span class="n">h4x</span><span class="p">)</span><span class="o">*</span><span class="mf">0.45</span><span class="p">,(</span><span class="n">i1y</span><span class="o">+</span><span class="n">h4y</span><span class="p">)</span><span class="o">*</span><span class="mf">0.5</span><span class="o">-</span><span class="mf">0.05</span><span class="p">),</span><span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightcoral&#39;</span><span class="p">,</span>
             <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round,pad=0.0&quot;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">),</span><span class="n">rotation</span><span class="o">=-</span><span class="mi">18</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\lambda_{2,4}$ = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">w24</span><span class="p">[</span><span class="n">iepoch</span><span class="p">],</span><span class="mi">2</span><span class="p">)),((</span><span class="n">i2x</span><span class="o">+</span><span class="n">h4x</span><span class="p">)</span><span class="o">*</span><span class="mf">0.45</span><span class="o">-</span><span class="mf">0.3</span><span class="p">,(</span><span class="n">i2y</span><span class="o">+</span><span class="n">h4y</span><span class="p">)</span><span class="o">*</span><span class="mf">0.5</span><span class="o">-</span><span class="mf">0.03</span><span class="p">),</span><span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>
             <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round,pad=0.0&quot;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">),</span><span class="n">rotation</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\lambda_{3,4}$ = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">w34</span><span class="p">[</span><span class="n">iepoch</span><span class="p">],</span><span class="mi">2</span><span class="p">)),((</span><span class="n">i3x</span><span class="o">+</span><span class="n">h4x</span><span class="p">)</span><span class="o">*</span><span class="mf">0.45</span><span class="o">-</span><span class="mf">1.2</span><span class="p">,(</span><span class="n">i3y</span><span class="o">+</span><span class="n">h4y</span><span class="p">)</span><span class="o">*</span><span class="mf">0.5</span><span class="o">-</span><span class="mf">1.1</span><span class="p">),</span><span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkred&#39;</span><span class="p">,</span>
             <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round,pad=0.0&quot;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">),</span><span class="n">rotation</span><span class="o">=</span><span class="mi">38</span><span class="p">)</span> 

<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\lambda_{1,5}$ = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">w15</span><span class="p">[</span><span class="n">iepoch</span><span class="p">],</span><span class="mi">2</span><span class="p">)),((</span><span class="n">i1x</span><span class="o">+</span><span class="n">h5x</span><span class="p">)</span><span class="o">*</span><span class="mf">0.55</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,(</span><span class="n">i1y</span><span class="o">+</span><span class="n">h5y</span><span class="p">)</span><span class="o">*</span><span class="mf">0.5</span><span class="o">+</span><span class="mf">0.9</span><span class="p">),</span><span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">,</span>
    <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round,pad=0.0&quot;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">),</span><span class="n">rotation</span><span class="o">=-</span><span class="mi">36</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\lambda_{2,5}$ = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">w25</span><span class="p">[</span><span class="n">iepoch</span><span class="p">],</span><span class="mi">2</span><span class="p">)),((</span><span class="n">i2x</span><span class="o">+</span><span class="n">h5x</span><span class="p">)</span><span class="o">*</span><span class="mf">0.55</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,(</span><span class="n">i2y</span><span class="o">+</span><span class="n">h5y</span><span class="p">)</span><span class="o">*</span><span class="mf">0.5</span><span class="o">+</span><span class="mf">0.05</span><span class="p">),</span><span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span>
             <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round,pad=0.0&quot;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">),</span><span class="n">rotation</span><span class="o">=-</span><span class="mi">12</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\lambda_{3,5}$ = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">w35</span><span class="p">[</span><span class="n">iepoch</span><span class="p">],</span><span class="mi">2</span><span class="p">)),((</span><span class="n">i3x</span><span class="o">+</span><span class="n">h5x</span><span class="p">)</span><span class="o">*</span><span class="mf">0.55</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,(</span><span class="n">i3y</span><span class="o">+</span><span class="n">h5y</span><span class="p">)</span><span class="o">*</span><span class="mf">0.5</span><span class="o">+</span><span class="mf">0.1</span><span class="p">),</span><span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkblue&#39;</span><span class="p">,</span>
             <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round,pad=0.0&quot;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">),</span><span class="n">rotation</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> 

<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\lambda_{4,6}$ = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">w46</span><span class="p">[</span><span class="n">iepoch</span><span class="p">],</span><span class="mi">2</span><span class="p">)),((</span><span class="n">h4x</span><span class="o">+</span><span class="n">o6x</span><span class="p">)</span><span class="o">*</span><span class="mf">0.47</span><span class="p">,(</span><span class="n">h4y</span><span class="o">+</span><span class="n">o6y</span><span class="p">)</span><span class="o">*</span><span class="mf">0.47</span><span class="o">+</span><span class="mf">0.39</span><span class="p">),</span><span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span>
    <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round,pad=0.0&quot;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">),</span><span class="n">rotation</span><span class="o">=-</span><span class="mi">12</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\lambda_{5,6}$ = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">w56</span><span class="p">[</span><span class="n">iepoch</span><span class="p">],</span><span class="mi">2</span><span class="p">)),((</span><span class="n">h5x</span><span class="o">+</span><span class="n">o6x</span><span class="p">)</span><span class="o">*</span><span class="mf">0.47</span><span class="p">,(</span><span class="n">h5y</span><span class="o">+</span><span class="n">o6y</span><span class="p">)</span><span class="o">*</span><span class="mf">0.47</span><span class="o">+</span><span class="mf">0.26</span><span class="p">),</span><span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkorange&#39;</span><span class="p">,</span>
    <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round,pad=0.0&quot;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">),</span><span class="n">rotation</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span> 

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lint_intx</span><span class="p">(</span><span class="n">i1x</span><span class="p">,</span> <span class="n">i1y</span><span class="p">,</span> <span class="n">h4x</span><span class="p">,</span> <span class="n">h4y</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.6</span><span class="p">),</span><span class="n">lint_inty</span><span class="p">(</span><span class="n">i1x</span><span class="p">,</span><span class="n">i1y</span><span class="p">,</span><span class="n">h4x</span><span class="p">,</span><span class="n">h4y</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.6</span><span class="p">)</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightcoral&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lint_int_arrx</span><span class="p">(</span><span class="n">h4x</span><span class="p">,</span><span class="n">h4y</span><span class="p">,</span><span class="n">i1x</span><span class="p">,</span><span class="n">i1y</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.2</span><span class="p">),</span><span class="n">lint_int_arry</span><span class="p">(</span><span class="n">h4x</span><span class="p">,</span><span class="n">h4y</span><span class="p">,</span><span class="n">i1x</span><span class="p">,</span><span class="n">i1y</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.2</span><span class="p">)</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightcoral&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\frac{\partial P}{\partial \lambda_{1,4}} =$&#39;</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;$</span><span class="si">{0:s}</span><span class="s1">$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">as_si</span><span class="p">(</span><span class="n">dw14</span><span class="p">[</span><span class="n">iepoch</span><span class="p">]</span><span class="o">/</span><span class="n">lr</span><span class="p">,</span><span class="mi">2</span><span class="p">)),(</span><span class="n">lintx</span><span class="p">(</span><span class="n">i1x</span><span class="p">,</span><span class="n">i1y</span><span class="p">,</span><span class="n">h4x</span><span class="p">,</span><span class="n">h4y</span><span class="p">,</span><span class="mf">0.5</span><span class="p">)</span><span class="o">-</span><span class="mf">0.6</span><span class="p">,</span><span class="n">linty</span><span class="p">(</span><span class="n">i1x</span><span class="p">,</span><span class="n">i1y</span><span class="p">,</span><span class="n">h4x</span><span class="p">,</span><span class="n">h4y</span><span class="p">,</span><span class="mf">0.5</span><span class="p">)</span><span class="o">-</span><span class="mf">1.0</span><span class="p">),</span><span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightcoral&#39;</span><span class="p">,</span>
              <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round,pad=0.0&quot;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">),</span><span class="n">rotation</span><span class="o">=-</span><span class="mi">20</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lint_intx</span><span class="p">(</span><span class="n">i2x</span><span class="p">,</span> <span class="n">i2y</span><span class="p">,</span> <span class="n">h4x</span><span class="p">,</span> <span class="n">h4y</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.5</span><span class="p">),</span><span class="n">lint_inty</span><span class="p">(</span><span class="n">i2x</span><span class="p">,</span><span class="n">i2y</span><span class="p">,</span><span class="n">h4x</span><span class="p">,</span><span class="n">h4y</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.5</span><span class="p">)</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lint_int_arrx</span><span class="p">(</span><span class="n">h4x</span><span class="p">,</span><span class="n">h4y</span><span class="p">,</span><span class="n">i2x</span><span class="p">,</span><span class="n">i2y</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.7</span><span class="p">,</span><span class="mf">0.2</span><span class="p">),</span><span class="n">lint_int_arry</span><span class="p">(</span><span class="n">h4x</span><span class="p">,</span><span class="n">h4y</span><span class="p">,</span><span class="n">i2x</span><span class="p">,</span><span class="n">i2y</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.7</span><span class="p">,</span><span class="mf">0.2</span><span class="p">)</span><span class="o">-</span><span class="mf">0.12</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\frac{\partial P}{\partial \lambda_{2,4}} =$&#39;</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;$</span><span class="si">{0:s}</span><span class="s1">$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">as_si</span><span class="p">(</span><span class="n">dw24</span><span class="p">[</span><span class="n">iepoch</span><span class="p">]</span><span class="o">/</span><span class="n">lr</span><span class="p">,</span><span class="mi">2</span><span class="p">)),(</span><span class="n">lintx</span><span class="p">(</span><span class="n">i2x</span><span class="p">,</span><span class="n">i2y</span><span class="p">,</span><span class="n">h4x</span><span class="p">,</span><span class="n">h4y</span><span class="p">,</span><span class="mf">0.5</span><span class="p">)</span><span class="o">-</span><span class="mf">1.05</span><span class="p">,</span><span class="n">linty</span><span class="p">(</span><span class="n">i2x</span><span class="p">,</span><span class="n">i2y</span><span class="p">,</span><span class="n">h4x</span><span class="p">,</span><span class="n">h4y</span><span class="p">,</span><span class="mf">0.5</span><span class="p">)</span><span class="o">-</span><span class="mf">0.7</span><span class="p">),</span><span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>
              <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round,pad=0.0&quot;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">),</span><span class="n">rotation</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lint_intx</span><span class="p">(</span><span class="n">i3x</span><span class="p">,</span> <span class="n">i3y</span><span class="p">,</span> <span class="n">h4x</span><span class="p">,</span> <span class="n">h4y</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.4</span><span class="p">),</span><span class="n">lint_inty</span><span class="p">(</span><span class="n">i3x</span><span class="p">,</span><span class="n">i3y</span><span class="p">,</span><span class="n">h4x</span><span class="p">,</span><span class="n">h4y</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.4</span><span class="p">)</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkred&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lint_int_arrx</span><span class="p">(</span><span class="n">h4x</span><span class="p">,</span><span class="n">h4y</span><span class="p">,</span><span class="n">i3x</span><span class="p">,</span><span class="n">i3y</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.2</span><span class="p">),</span><span class="n">lint_int_arry</span><span class="p">(</span><span class="n">h4x</span><span class="p">,</span><span class="n">h4y</span><span class="p">,</span><span class="n">i3x</span><span class="p">,</span><span class="n">i3y</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.2</span><span class="p">)</span><span class="o">-</span><span class="mf">0.12</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkred&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\frac{\partial P}{\partial \lambda_{3,4}} =$&#39;</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;$</span><span class="si">{0:s}</span><span class="s1">$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">as_si</span><span class="p">(</span><span class="n">dw34</span><span class="p">[</span><span class="n">iepoch</span><span class="p">]</span><span class="o">/</span><span class="n">lr</span><span class="p">,</span><span class="mi">2</span><span class="p">)),(</span><span class="n">lintx</span><span class="p">(</span><span class="n">i3x</span><span class="p">,</span><span class="n">i3y</span><span class="p">,</span><span class="n">h4x</span><span class="p">,</span><span class="n">h4y</span><span class="p">,</span><span class="mf">0.5</span><span class="p">)</span><span class="o">-</span><span class="mf">1.7</span><span class="p">,</span><span class="n">linty</span><span class="p">(</span><span class="n">i3x</span><span class="p">,</span><span class="n">i3y</span><span class="p">,</span><span class="n">h4x</span><span class="p">,</span><span class="n">h4y</span><span class="p">,</span><span class="mf">0.5</span><span class="p">)</span><span class="o">-</span><span class="mf">1.7</span><span class="p">),</span><span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkred&#39;</span><span class="p">,</span>
              <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round,pad=0.0&quot;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">),</span><span class="n">rotation</span><span class="o">=</span><span class="mi">38</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lint_intx</span><span class="p">(</span><span class="n">i3x</span><span class="p">,</span> <span class="n">i3y</span><span class="p">,</span> <span class="n">h5x</span><span class="p">,</span> <span class="n">h5y</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.6</span><span class="p">),</span><span class="n">lint_inty</span><span class="p">(</span><span class="n">i3x</span><span class="p">,</span><span class="n">i3y</span><span class="p">,</span><span class="n">h5x</span><span class="p">,</span><span class="n">h5y</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.6</span><span class="p">)</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkblue&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lint_int_arrx</span><span class="p">(</span><span class="n">h5x</span><span class="p">,</span><span class="n">h5y</span><span class="p">,</span><span class="n">i3x</span><span class="p">,</span><span class="n">i3y</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.2</span><span class="p">),</span><span class="n">lint_int_arry</span><span class="p">(</span><span class="n">h5x</span><span class="p">,</span><span class="n">h5y</span><span class="p">,</span><span class="n">i3x</span><span class="p">,</span><span class="n">i3y</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.2</span><span class="p">)</span><span class="o">-</span><span class="mf">0.12</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkblue&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\frac{\partial P}{\partial \lambda_{3,5}} =$&#39;</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;$</span><span class="si">{0:s}</span><span class="s1">$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">as_si</span><span class="p">(</span><span class="n">dw35</span><span class="p">[</span><span class="n">iepoch</span><span class="p">]</span><span class="o">/</span><span class="n">lr</span><span class="p">,</span><span class="mi">2</span><span class="p">)),(</span><span class="n">lintx</span><span class="p">(</span><span class="n">i3x</span><span class="p">,</span><span class="n">i3y</span><span class="p">,</span><span class="n">h5x</span><span class="p">,</span><span class="n">h5y</span><span class="p">,</span><span class="mf">0.5</span><span class="p">)</span><span class="o">-</span><span class="mf">0.4</span><span class="p">,</span><span class="n">linty</span><span class="p">(</span><span class="n">i3x</span><span class="p">,</span><span class="n">i3y</span><span class="p">,</span><span class="n">h5x</span><span class="p">,</span><span class="n">h5y</span><span class="p">,</span><span class="mf">0.5</span><span class="p">)</span><span class="o">-</span><span class="mf">0.6</span><span class="p">),</span><span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkblue&#39;</span><span class="p">,</span>
              <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round,pad=0.0&quot;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">),</span><span class="n">rotation</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lint_intx</span><span class="p">(</span><span class="n">i2x</span><span class="p">,</span> <span class="n">i2y</span><span class="p">,</span> <span class="n">h5x</span><span class="p">,</span> <span class="n">h5y</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.5</span><span class="p">),</span><span class="n">lint_inty</span><span class="p">(</span><span class="n">i2x</span><span class="p">,</span><span class="n">i2y</span><span class="p">,</span><span class="n">h5x</span><span class="p">,</span><span class="n">h5y</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.5</span><span class="p">)</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lint_int_arrx</span><span class="p">(</span><span class="n">h5x</span><span class="p">,</span><span class="n">h5y</span><span class="p">,</span><span class="n">i2x</span><span class="p">,</span><span class="n">i2y</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.7</span><span class="p">,</span><span class="mf">0.2</span><span class="p">),</span><span class="n">lint_int_arry</span><span class="p">(</span><span class="n">h5x</span><span class="p">,</span><span class="n">h5y</span><span class="p">,</span><span class="n">i2x</span><span class="p">,</span><span class="n">i2y</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.7</span><span class="p">,</span><span class="mf">0.2</span><span class="p">)</span><span class="o">-</span><span class="mf">0.12</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\frac{\partial P}{\partial \lambda_{2,5}} =$&#39;</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;$</span><span class="si">{0:s}</span><span class="s1">$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">as_si</span><span class="p">(</span><span class="n">dw25</span><span class="p">[</span><span class="n">iepoch</span><span class="p">]</span><span class="o">/</span><span class="n">lr</span><span class="p">,</span><span class="mi">2</span><span class="p">)),(</span><span class="n">lintx</span><span class="p">(</span><span class="n">i2x</span><span class="p">,</span><span class="n">i2y</span><span class="p">,</span><span class="n">h5x</span><span class="p">,</span><span class="n">h5y</span><span class="p">,</span><span class="mf">0.5</span><span class="p">)</span><span class="o">-</span><span class="mf">1.2</span><span class="p">,</span><span class="n">linty</span><span class="p">(</span><span class="n">i2x</span><span class="p">,</span><span class="n">i2y</span><span class="p">,</span><span class="n">h5x</span><span class="p">,</span><span class="n">h5y</span><span class="p">,</span><span class="mf">0.5</span><span class="p">)</span><span class="o">-</span><span class="mf">0.65</span><span class="p">),</span><span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span>
              <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round,pad=0.0&quot;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">),</span><span class="n">rotation</span><span class="o">=-</span><span class="mi">12</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lint_intx</span><span class="p">(</span><span class="n">i1x</span><span class="p">,</span> <span class="n">i1y</span><span class="p">,</span> <span class="n">h5x</span><span class="p">,</span> <span class="n">h5y</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.4</span><span class="p">),</span><span class="n">lint_inty</span><span class="p">(</span><span class="n">i1x</span><span class="p">,</span><span class="n">i1y</span><span class="p">,</span><span class="n">h5x</span><span class="p">,</span><span class="n">h5y</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.4</span><span class="p">)</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lint_int_arrx</span><span class="p">(</span><span class="n">h5x</span><span class="p">,</span><span class="n">h5y</span><span class="p">,</span><span class="n">i1x</span><span class="p">,</span><span class="n">i1y</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.2</span><span class="p">),</span><span class="n">lint_int_arry</span><span class="p">(</span><span class="n">h5x</span><span class="p">,</span><span class="n">h5y</span><span class="p">,</span><span class="n">i1x</span><span class="p">,</span><span class="n">i1y</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.2</span><span class="p">)</span><span class="o">-</span><span class="mf">0.12</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\frac{\partial P}{\partial \lambda_{1,5}} =$&#39;</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;$</span><span class="si">{0:s}</span><span class="s1">$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">as_si</span><span class="p">(</span><span class="n">dw15</span><span class="p">[</span><span class="n">iepoch</span><span class="p">]</span><span class="o">/</span><span class="n">lr</span><span class="p">,</span><span class="mi">2</span><span class="p">)),(</span><span class="n">lintx</span><span class="p">(</span><span class="n">i1x</span><span class="p">,</span><span class="n">i1y</span><span class="p">,</span><span class="n">h5x</span><span class="p">,</span><span class="n">h5y</span><span class="p">,</span><span class="mf">0.5</span><span class="p">)</span><span class="o">-</span><span class="mf">2.2</span><span class="p">,</span><span class="n">linty</span><span class="p">(</span><span class="n">i1x</span><span class="p">,</span><span class="n">i1y</span><span class="p">,</span><span class="n">h4x</span><span class="p">,</span><span class="n">h4y</span><span class="p">,</span><span class="mf">0.5</span><span class="p">)</span><span class="o">-</span><span class="mf">1.5</span><span class="p">),</span><span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">,</span>
              <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round,pad=0.0&quot;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">),</span><span class="n">rotation</span><span class="o">=-</span><span class="mi">36</span><span class="p">,</span><span class="n">xycoords</span> <span class="o">=</span> <span class="s1">&#39;data&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/f1c2dc9fc05ec8a3d07b5642c59c42dd91a2b2ed35c547faa409371a1e776270.png" src="_images/f1c2dc9fc05ec8a3d07b5642c59c42dd91a2b2ed35c547faa409371a1e776270.png" />
</div>
</div>
</section>
<section id="check-the-ann-convergence">
<h2>Check the ANN Convergence<a class="headerlink" href="#check-the-ann-convergence" title="Permalink to this heading">#</a></h2>
<p>Now we plot the weights, biases and prediction over the epochs to check the training convergence.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">131</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nepoch</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">y6</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\hat</span><span class="si">{y}</span><span class="s1">$&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="n">nepoch</span><span class="p">]);</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Epochs&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\hat</span><span class="si">{y}</span><span class="s1">$&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Simple Artificial Neural Network Prediction&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="n">nepoch</span><span class="p">],[</span><span class="n">y</span><span class="p">,</span><span class="n">y</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">add_grid</span><span class="p">();</span> <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">132</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nepoch</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">w14</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightcoral&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$\lambda_{1,4}$&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nepoch</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">w24</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$\lambda_{2,4}$&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nepoch</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">w34</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkred&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$\lambda_{3,4}$&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nepoch</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">w15</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$\lambda_{1,5}$&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nepoch</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">w25</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$\lambda_{2,5}$&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nepoch</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">w35</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkblue&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$\lambda_{3,5}$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nepoch</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">w46</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$\lambda_{4,6}$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nepoch</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">w56</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkorange&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$\lambda_{5,6}$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="n">nepoch</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="n">nepoch</span><span class="p">]);</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">]);</span> <span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Epochs&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\hat</span><span class="si">{y}</span><span class="s1">$&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Simple Artificial Neural Network Weights&#39;</span><span class="p">)</span>
<span class="n">add_grid</span><span class="p">();</span> <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">133</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nepoch</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">w14</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightgreen&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$\phi_</span><span class="si">{4}</span><span class="s1">$&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nepoch</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">w24</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$\phi_</span><span class="si">{5}</span><span class="s1">$&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nepoch</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">w34</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkgreen&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$\phi_</span><span class="si">{6}</span><span class="s1">$&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="n">nepoch</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="n">nepoch</span><span class="p">]);</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">]);</span> <span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Epochs&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\hat</span><span class="si">{y}</span><span class="s1">$&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Simple Artificial Neural Network Biases&#39;</span><span class="p">)</span>
<span class="n">add_grid</span><span class="p">();</span> <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/96a2f9a7007123700054af340b223a0c9017cbf262afe43f97c8f1b445ec44a6.png" src="_images/96a2f9a7007123700054af340b223a0c9017cbf262afe43f97c8f1b445ec44a6.png" />
</div>
</div>
</section>
<section id="comments">
<h2>Comments<a class="headerlink" href="#comments" title="Permalink to this heading">#</a></h2>
<p>This was a basic treatment of artificial neural networks. Much more could be done and discussed, I have many more resources. Check out my <a class="reference external" href="https://michaelpyrcz.com/my-resources">shared resource inventory</a> and the YouTube lecture links at the start of this chapter with resource links in the videos‚Äô descriptions.</p>
<p>I hope this is helpful,</p>
<p><em>Michael</em></p>
</section>
<section id="about-the-author">
<h2>About the Author<a class="headerlink" href="#about-the-author" title="Permalink to this heading">#</a></h2>
<figure style="text-align: center;">
  <img src="_static/intro/michael_pyrcz_officeshot_jacket.jpg" style="display: block; margin: 0 auto; width: 70%;">
  <figcaption style="text-align: center;"> Professor Michael Pyrcz in his office on the 40 acres, campus of The University of Texas at Austin.
</figcaption>
</figure>
<p>Michael Pyrcz is a professor in the <a class="reference external" href="https://cockrell.utexas.edu/faculty-directory/alphabetical/p">Cockrell School of Engineering</a>, and the <a class="reference external" href="https://www.jsg.utexas.edu/researcher/michael_pyrcz/">Jackson School of Geosciences</a>, at <a class="reference external" href="https://www.utexas.edu/">The University of Texas at Austin</a>, where he researches and teaches subsurface, spatial data analytics, geostatistics, and machine learning. Michael is also,</p>
<ul class="simple">
<li><p>the principal investigator of the <a class="reference external" href="https://fri.cns.utexas.edu/energy-analytics">Energy Analytics</a> freshmen research initiative and a core faculty in the Machine Learn Laboratory in the College of Natural Sciences, The University of Texas at Austin</p></li>
<li><p>an associate editor for <a class="reference external" href="https://www.sciencedirect.com/journal/computers-and-geosciences/about/editorial-board">Computers and Geosciences</a>, and a board member for <a class="reference external" href="https://link.springer.com/journal/11004/editorial-board">Mathematical Geosciences</a>, the International Association for Mathematical Geosciences.</p></li>
</ul>
<p>Michael has written over 70 <a class="reference external" href="https://scholar.google.com/citations?user=QVZ20eQAAAAJ&amp;hl=en">peer-reviewed publications</a>, a <a class="reference external" href="https://pypi.org/project/geostatspy/">Python package</a> for spatial data analytics, co-authored a textbook on spatial data analytics, <a class="reference external" href="https://www.amazon.com/Geostatistical-Reservoir-Modeling-Michael-Pyrcz/dp/0199731446">Geostatistical Reservoir Modeling</a> and author of two recently released e-books, <a class="reference external" href="https://geostatsguy.github.io/GeostatsPyDemos_Book/intro.html">Applied Geostatistics in Python: a Hands-on Guide with GeostatsPy</a> and <a class="reference external" href="https://geostatsguy.github.io/MachineLearningDemos_Book/intro.html">Applied Machine Learning in Python: a Hands-on Guide with Code</a>.</p>
<p>All of Michael‚Äôs university lectures are available on his <a class="reference external" href="https://www.youtube.com/&#64;GeostatsGuyLectures">YouTube Channel</a> with links to 100s of Python interactive dashboards and well-documented workflows in over 40 repositories on his <a class="reference external" href="https://github.com/GeostatsGuy">GitHub account</a>, to support any interested students and working professionals with evergreen content. To find out more about Michael‚Äôs work and shared educational resources visit his <span class="xref myst">Website</span>.</p>
</section>
<section id="want-to-work-together">
<h2>Want to Work Together?<a class="headerlink" href="#want-to-work-together" title="Permalink to this heading">#</a></h2>
<p>I hope this content is helpful to those that want to learn more about subsurface modeling, data analytics and machine learning. Students and working professionals are welcome to participate.</p>
<ul class="simple">
<li><p>Want to invite me to visit your company for training, mentoring, project review, workflow design and / or consulting? I‚Äôd be happy to drop by and work with you!</p></li>
<li><p>Interested in partnering, supporting my graduate student research or my Subsurface Data Analytics and Machine Learning consortium (co-PI is Professor John Foster)? My research combines data analytics, stochastic modeling and machine learning theory with practice to develop novel methods and workflows to add value. We are solving challenging subsurface problems!</p></li>
<li><p>I can be reached at <a class="reference external" href="mailto:mpyrcz&#37;&#52;&#48;austin&#46;utexas&#46;edu">mpyrcz<span>&#64;</span>austin<span>&#46;</span>utexas<span>&#46;</span>edu</a>.</p></li>
</ul>
<p>I‚Äôm always happy to discuss,</p>
<p><em>Michael</em></p>
<p>Michael Pyrcz, Ph.D., P.Eng. Professor, Cockrell School of Engineering and The Jackson School of Geosciences, The University of Texas at Austin</p>
<p>More Resources Available at: <a class="reference external" href="https://twitter.com/geostatsguy">Twitter</a> | <a class="reference external" href="https://github.com/GeostatsGuy">GitHub</a> | <a class="reference external" href="http://michaelpyrcz.com">Website</a> | <a class="reference external" href="https://scholar.google.com/citations?user=QVZ20eQAAAAJ&amp;hl=en&amp;oi=ao">GoogleScholar</a> | <a class="reference external" href="https://www.amazon.com/Geostatistical-Reservoir-Modeling-Michael-Pyrcz/dp/0199731446">Geostatistics Book</a> | <a class="reference external" href="https://www.youtube.com/channel/UCLqEr-xV-ceHdXXXrTId5ig">YouTube</a>  | <a class="reference external" href="https://geostatsguy.github.io/GeostatsPyDemos_Book/intro.html">Applied Geostats in Python e-book</a> | <a class="reference external" href="https://geostatsguy.github.io/MachineLearningDemos_Book/">Applied Machine Learning in Python e-book</a> | <a class="reference external" href="https://www.linkedin.com/in/michael-pyrcz-61a648a1">LinkedIn</a></p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="MachineLearning_support_vector_machines.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Support Vector Machines</p>
      </div>
    </a>
    <a class="right-next"
       href="MachineLearning_time_series.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Time Series Analysis and Modeling</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#motivation">Motivation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#concepts">Concepts</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-simple-network">A Simple Network</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#walkthrough-the-network">Walkthrough the Network</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#number-of-model-parameters">Number of Model Parameters</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#activation-functions">Activation Functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#training-model-parameters">Training Model Parameters</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#backpropagation">Backpropagation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#updating-model-parameters">Updating Model Parameters</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#training-epochs">Training Epochs</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interactive-dashboard">Interactive Dashboard</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-required-packages">Import Required Packages</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#declare-functions">Declare Functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-simple-ann">The Simple ANN</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#now-visualize-the-network-for-a-specific-epoch">Now Visualize the Network for a Specific Epoch</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#check-the-ann-convergence">Check the ANN Convergence</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comments">Comments</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#about-the-author">About the Author</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#want-to-work-together">Want to Work Together?</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Michael J. Pyrcz
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      ¬© Copyright 2024 CC-BY-SA 4.0.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>